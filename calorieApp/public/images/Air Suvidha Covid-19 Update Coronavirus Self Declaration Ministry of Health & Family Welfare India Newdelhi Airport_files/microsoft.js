!function (e) { var t = {}; function n(r) { if (t[r]) return t[r].exports; var o = t[r] = { i: r, l: !1, exports: {} }; return e[r].call(o.exports, o, o.exports, n), o.l = !0, o.exports } n.m = e, n.c = t, n.d = function (e, t, r) { n.o(e, t) || Object.defineProperty(e, t, { configurable: !1, enumerable: !0, get: r }) }, n.n = function (e) { var t = e && e.__esModule ? function () { return e.default } : function () { return e }; return n.d(t, "a", t), t }, n.o = function (e, t) { return Object.prototype.hasOwnProperty.call(e, t) }, n.p = "", n(n.s = 21) }([function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var r = n(35); t.AudioConfig = r.AudioConfig; var o = n(18); t.AudioStreamFormat = o.AudioStreamFormat; var i = n(17); t.AudioInputStream = i.AudioInputStream, t.PullAudioInputStream = i.PullAudioInputStream, t.PushAudioInputStream = i.PushAudioInputStream; var s = n(36); t.CancellationReason = s.CancellationReason; var c = n(37); t.PullAudioInputStreamCallback = c.PullAudioInputStreamCallback; var a = n(38); t.KeywordRecognitionModel = a.KeywordRecognitionModel; var u = n(39); t.SessionEventArgs = u.SessionEventArgs; var p = n(40); t.RecognitionEventArgs = p.RecognitionEventArgs; var l = n(41); t.OutputFormat = l.OutputFormat; var f = n(42); t.IntentRecognitionEventArgs = f.IntentRecognitionEventArgs; var d = n(43); t.RecognitionResult = d.RecognitionResult; var h = n(44); t.SpeechRecognitionResult = h.SpeechRecognitionResult; var g = n(45); t.IntentRecognitionResult = g.IntentRecognitionResult; var v = n(46); t.LanguageUnderstandingModel = v.LanguageUnderstandingModel; var y = n(47); t.SpeechRecognitionEventArgs = y.SpeechRecognitionEventArgs; var m = n(48); t.SpeechRecognitionCanceledEventArgs = m.SpeechRecognitionCanceledEventArgs; var b = n(49); t.TranslationRecognitionEventArgs = b.TranslationRecognitionEventArgs; var S = n(50); t.TranslationSynthesisEventArgs = S.TranslationSynthesisEventArgs; var R = n(51); t.TranslationRecognitionResult = R.TranslationRecognitionResult; var P = n(52); t.TranslationSynthesisResult = P.TranslationSynthesisResult; var O = n(53); t.ResultReason = O.ResultReason; var I = n(54); t.SpeechConfig = I.SpeechConfig; var C = n(80); t.SpeechTranslationConfig = C.SpeechTranslationConfig; var E = n(81); t.PropertyCollection = E.PropertyCollection; var w = n(82); t.PropertyId = w.PropertyId; var _ = n(83); t.Recognizer = _.Recognizer; var T = n(84); t.SpeechRecognizer = T.SpeechRecognizer; var A = n(85); t.IntentRecognizer = A.IntentRecognizer; var j = n(86); t.TranslationRecognizer = j.TranslationRecognizer; var D = n(87); t.Translations = D.Translations; var M = n(88); t.NoMatchReason = M.NoMatchReason; var N = n(89); t.NoMatchDetails = N.NoMatchDetails; var z = n(90); t.TranslationRecognitionCanceledEventArgs = z.TranslationRecognitionCanceledEventArgs; var F = n(91); t.IntentRecognitionCanceledEventArgs = F.IntentRecognitionCanceledEventArgs; var x = n(92); t.CancellationDetails = x.CancellationDetails; var k = n(93); t.CancellationErrorCode = k.CancellationErrorCode }, function (e, t, n) { "use strict"; function r(e) { for (var n in e) t.hasOwnProperty(n) || (t[n] = e[n]) } Object.defineProperty(t, "__esModule", { value: !0 }), r(n(24)), r(n(25)), r(n(11)), r(n(26)), r(n(3)), r(n(27)), r(n(12)), r(n(5)), r(n(28)), r(n(13)), r(n(14)), r(n(7)), r(n(15)), r(n(16)), r(n(29)), r(n(30)), r(n(31)), r(n(32)); var o = n(8); t.TranslationStatus = o.TranslationStatus }, function (e, t, n) { "use strict"; function r(e) { for (var n in e) t.hasOwnProperty(n) || (t[n] = e[n]) } Object.defineProperty(t, "__esModule", { value: !0 }), r(n(55)), r(n(56)), r(n(9)), r(n(57)), r(n(10)), r(n(58)), r(n(60)), r(n(61)), r(n(19)), r(n(63)), r(n(64)), r(n(65)), r(n(66)), r(n(67)), r(n(68)), r(n(69)), r(n(70)), r(n(71)), r(n(72)), r(n(73)), r(n(74)), r(n(75)), r(n(76)), r(n(77)), r(n(78)), t.OutputFormatPropertyName = "OutputFormat", t.CancellationErrorCodePropertyName = "CancellationErrorCode" }, function (e, t, n) { "use strict"; var r, o = this && this.__extends || (r = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (e, t) { e.__proto__ = t } || function (e, t) { for (var n in t) t.hasOwnProperty(n) && (e[n] = t[n]) }, function (e, t) { function n() { this.constructor = e } r(e, t), e.prototype = null === t ? Object.create(t) : (n.prototype = t.prototype, new n) }); Object.defineProperty(t, "__esModule", { value: !0 }); var i = function (e) { function t(t) { var n = e.call(this, t) || this; return n.name = "ArgumentNull", n.message = t, n } return o(t, e), t }(Error); t.ArgumentNullError = i; var s = function (e) { function t(t) { var n = e.call(this, t) || this; return n.name = "InvalidOperation", n.message = t, n } return o(t, e), t }(Error); t.InvalidOperationError = s; var c = function (e) { function t(t, n) { var r = e.call(this, n) || this; return r.name = t + "ObjectDisposed", r.message = n, r } return o(t, e), t }(Error); t.ObjectDisposedError = c }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var r = function () { function e() { } return e.throwIfNullOrUndefined = function (e, t) { if (null == e) throw new Error("throwIfNullOrUndefined:" + t) }, e.throwIfNull = function (e, t) { if (null === e) throw new Error("throwIfNull:" + t) }, e.throwIfNullOrWhitespace = function (t, n) { if (e.throwIfNullOrUndefined(t, n), ("" + t).trim().length < 1) throw new Error("throwIfNullOrWhitespace:" + n) }, e.throwIfDisposed = function (e) { if (e) throw new Error("the object is already disposed") }, e.throwIfArrayEmptyOrWhitespace = function (t, n) { if (e.throwIfNullOrUndefined(t, n), 0 === t.length) throw new Error("throwIfArrayEmptyOrWhitespace:" + n); for (var r = 0, o = t; r < o.length; r++) { var i = o[r]; e.throwIfNullOrWhitespace(i, n) } }, e.throwIfFileDoesNotExist = function (t, n) { e.throwIfNullOrWhitespace(t, n) }, e }(); t.Contracts = r }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var r = function () { var e = (new Date).getTime(); return "xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g, function (t) { var n = (e + 16 * Math.random()) % 16 | 0; return e = Math.floor(e / 16), ("x" === t ? n : 3 & n | 8).toString(16) }) }; t.CreateGuid = r; t.CreateNoDashGuid = function () { return r().replace(new RegExp("-", "g"), "").toUpperCase() } }, function (e, t, n) { "use strict"; function r(e) { for (var n in e) t.hasOwnProperty(n) || (t[n] = e[n]) } Object.defineProperty(t, "__esModule", { value: !0 }), r(n(23)), r(n(33)), r(n(34)), r(n(94)), r(n(95)), r(n(96)), r(n(97)), r(n(98)), r(n(99)), r(n(20)) }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var r = n(5); !function (e) { e[e.Debug = 0] = "Debug", e[e.Info = 1] = "Info", e[e.Warning = 2] = "Warning", e[e.Error = 3] = "Error" }(t.EventType || (t.EventType = {})); var o = function () { function e(e, t) { this.name = e, this.eventId = r.CreateNoDashGuid(), this.eventTime = (new Date).toISOString(), this.eventType = t, this.metadata = {} } return Object.defineProperty(e.prototype, "Name", { get: function () { return this.name }, enumerable: !0, configurable: !0 }), Object.defineProperty(e.prototype, "EventId", { get: function () { return this.eventId }, enumerable: !0, configurable: !0 }), Object.defineProperty(e.prototype, "EventTime", { get: function () { return this.eventTime }, enumerable: !0, configurable: !0 }), Object.defineProperty(e.prototype, "EventType", { get: function () { return this.eventType }, enumerable: !0, configurable: !0 }), Object.defineProperty(e.prototype, "Metadata", { get: function () { return this.metadata }, enumerable: !0, configurable: !0 }), e }(); t.PlatformEvent = o }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }), function (e) { e[e.Success = 0] = "Success", e[e.Error = 1] = "Error" }(t.TranslationStatus || (t.TranslationStatus = {})) }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var r = function () { function e(e, t) { this.headerName = e, this.token = t } return Object.defineProperty(e.prototype, "HeaderName", { get: function () { return this.headerName }, enumerable: !0, configurable: !0 }), Object.defineProperty(e.prototype, "Token", { get: function () { return this.token }, enumerable: !0, configurable: !0 }), e }(); t.AuthInfo = r }, function (e, t, n) { "use strict"; var r, o = this && this.__extends || (r = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (e, t) { e.__proto__ = t } || function (e, t) { for (var n in t) t.hasOwnProperty(n) && (e[n] = t[n]) }, function (e, t) { function n() { this.constructor = e } r(e, t), e.prototype = null === t ? Object.create(t) : (n.prototype = t.prototype, new n) }); Object.defineProperty(t, "__esModule", { value: !0 }); var i = n(1), s = function (e) { function t(t, n, r, o) { void 0 === o && (o = i.EventType.Info); var s = e.call(this, t, o) || this; return s.requestId = n, s.sessionId = r, s } return o(t, e), Object.defineProperty(t.prototype, "RequestId", { get: function () { return this.requestId }, enumerable: !0, configurable: !0 }), Object.defineProperty(t.prototype, "SessionId", { get: function () { return this.sessionId }, enumerable: !0, configurable: !0 }), t }(i.PlatformEvent); t.SpeechRecognitionEvent = s; var c = function (e) { function t(t, n, r, o) { var i = e.call(this, "RecognitionTriggeredEvent", t, n) || this; return i.audioSourceId = r, i.audioNodeId = o, i } return o(t, e), Object.defineProperty(t.prototype, "AudioSourceId", { get: function () { return this.audioSourceId }, enumerable: !0, configurable: !0 }), Object.defineProperty(t.prototype, "AudioNodeId", { get: function () { return this.audioNodeId }, enumerable: !0, configurable: !0 }), t }(s); t.RecognitionTriggeredEvent = c; var a = function (e) { function t(t, n, r, o) { var i = e.call(this, "ListeningStartedEvent", t, n) || this; return i.audioSourceId = r, i.audioNodeId = o, i } return o(t, e), Object.defineProperty(t.prototype, "AudioSourceId", { get: function () { return this.audioSourceId }, enumerable: !0, configurable: !0 }), Object.defineProperty(t.prototype, "AudioNodeId", { get: function () { return this.audioNodeId }, enumerable: !0, configurable: !0 }), t }(s); t.ListeningStartedEvent = a; var u = function (e) { function t(t, n, r) { var o = e.call(this, "ConnectingToServiceEvent", t, r) || this; return o.authFetchEventid = n, o } return o(t, e), Object.defineProperty(t.prototype, "AuthFetchEventid", { get: function () { return this.authFetchEventid }, enumerable: !0, configurable: !0 }), t }(s); t.ConnectingToServiceEvent = u; var p, l = function (e) { function t(t, n, r, o, i) { var s = e.call(this, "RecognitionStartedEvent", t, i) || this; return s.audioSourceId = n, s.audioNodeId = r, s.authFetchEventId = o, s } return o(t, e), Object.defineProperty(t.prototype, "AudioSourceId", { get: function () { return this.audioSourceId }, enumerable: !0, configurable: !0 }), Object.defineProperty(t.prototype, "AudioNodeId", { get: function () { return this.audioNodeId }, enumerable: !0, configurable: !0 }), Object.defineProperty(t.prototype, "AuthFetchEventId", { get: function () { return this.authFetchEventId }, enumerable: !0, configurable: !0 }), t }(s); t.RecognitionStartedEvent = l, function (e) { e[e.Success = 0] = "Success", e[e.AudioSourceError = 1] = "AudioSourceError", e[e.AudioSourceTimeout = 2] = "AudioSourceTimeout", e[e.AuthTokenFetchError = 3] = "AuthTokenFetchError", e[e.AuthTokenFetchTimeout = 4] = "AuthTokenFetchTimeout", e[e.UnAuthorized = 5] = "UnAuthorized", e[e.ConnectTimeout = 6] = "ConnectTimeout", e[e.ConnectError = 7] = "ConnectError", e[e.ClientRecognitionActivityTimeout = 8] = "ClientRecognitionActivityTimeout", e[e.UnknownError = 9] = "UnknownError" }(p = t.RecognitionCompletionStatus || (t.RecognitionCompletionStatus = {})); var f = function (e) { function t(t, n, r, o, s, c, a, u) { var l = e.call(this, "RecognitionEndedEvent", t, s, a === p.Success ? i.EventType.Info : i.EventType.Error) || this; return l.audioSourceId = n, l.audioNodeId = r, l.authFetchEventId = o, l.status = a, l.error = u, l.serviceTag = c, l } return o(t, e), Object.defineProperty(t.prototype, "AudioSourceId", { get: function () { return this.audioSourceId }, enumerable: !0, configurable: !0 }), Object.defineProperty(t.prototype, "AudioNodeId", { get: function () { return this.audioNodeId }, enumerable: !0, configurable: !0 }), Object.defineProperty(t.prototype, "AuthFetchEventId", { get: function () { return this.authFetchEventId }, enumerable: !0, configurable: !0 }), Object.defineProperty(t.prototype, "ServiceTag", { get: function () { return this.serviceTag }, enumerable: !0, configurable: !0 }), Object.defineProperty(t.prototype, "Status", { get: function () { return this.status }, enumerable: !0, configurable: !0 }), Object.defineProperty(t.prototype, "Error", { get: function () { return this.error }, enumerable: !0, configurable: !0 }), t }(s); t.RecognitionEndedEvent = f }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var r, o = n(3), i = n(5); !function (e) { e[e.Text = 0] = "Text", e[e.Binary = 1] = "Binary" }(r = t.MessageType || (t.MessageType = {})); var s = function () { function e(e, t, n, s) { if (this.body = null, e === r.Text && t && "string" != typeof t) throw new o.InvalidOperationError("Payload must be a string"); if (e === r.Binary && t && !(t instanceof ArrayBuffer)) throw new o.InvalidOperationError("Payload must be ArrayBuffer"); this.messageType = e, this.body = t, this.headers = n || {}, this.id = s || i.CreateNoDashGuid() } return Object.defineProperty(e.prototype, "MessageType", { get: function () { return this.messageType }, enumerable: !0, configurable: !0 }), Object.defineProperty(e.prototype, "Headers", { get: function () { return this.headers }, enumerable: !0, configurable: !0 }), Object.defineProperty(e.prototype, "Body", { get: function () { return this.body }, enumerable: !0, configurable: !0 }), Object.defineProperty(e.prototype, "TextBody", { get: function () { if (this.messageType === r.Binary) throw new o.InvalidOperationError("Not supported for binary message"); return this.body }, enumerable: !0, configurable: !0 }), Object.defineProperty(e.prototype, "BinaryBody", { get: function () { if (this.messageType === r.Text) throw new o.InvalidOperationError("Not supported for text message"); return this.body }, enumerable: !0, configurable: !0 }), Object.defineProperty(e.prototype, "Id", { get: function () { return this.id }, enumerable: !0, configurable: !0 }), e }(); t.ConnectionMessage = s }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var r = n(3), o = n(5), i = function () { function e(e) { var t = this; this.eventListeners = {}, this.isDisposed = !1, this.OnEvent = function (e) { if (t.IsDisposed()) throw new r.ObjectDisposedError("EventSource"); if (t.Metadata) for (var n in t.Metadata) n && e.Metadata && (e.Metadata[n] || (e.Metadata[n] = t.Metadata[n])); for (var o in t.eventListeners) o && t.eventListeners[o] && t.eventListeners[o](e) }, this.Attach = function (e) { var n = o.CreateNoDashGuid(); return t.eventListeners[n] = e, { Detach: function () { delete t.eventListeners[n] } } }, this.AttachListener = function (e) { return t.Attach(e.OnEvent) }, this.IsDisposed = function () { return t.isDisposed }, this.Dispose = function () { t.eventListeners = null, t.isDisposed = !0 }, this.metadata = e } return Object.defineProperty(e.prototype, "Metadata", { get: function () { return this.metadata }, enumerable: !0, configurable: !0 }), e }(); t.EventSource = i }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var r = n(3), o = function () { return function () { var e = this; this.store = {}, this.Get = function (t) { if (!t) throw new r.ArgumentNullError("key"); return e.store[t] }, this.GetOrAdd = function (t, n) { if (!t) throw new r.ArgumentNullError("key"); return void 0 === e.store[t] && (e.store[t] = n), e.store[t] }, this.Set = function (t, n) { if (!t) throw new r.ArgumentNullError("key"); e.store[t] = n }, this.Remove = function (t) { if (!t) throw new r.ArgumentNullError("key"); void 0 !== e.store[t] && delete e.store[t] } } }(); t.InMemoryStorage = o }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var r = n(3), o = function () { return function e(t) { var n = this; if (this.subscriptionIdCounter = 0, this.addSubscriptions = {}, this.removeSubscriptions = {}, this.disposedSubscriptions = {}, this.disposeReason = null, this.Get = function (e) { return n.ThrowIfDisposed(), n.list[e] }, this.First = function () { return n.Get(0) }, this.Last = function () { return n.Get(n.Length() - 1) }, this.Add = function (e) { n.ThrowIfDisposed(), n.InsertAt(n.list.length, e) }, this.InsertAt = function (e, t) { n.ThrowIfDisposed(), 0 === e ? n.list.unshift(t) : e === n.list.length ? n.list.push(t) : n.list.splice(e, 0, t), n.TriggerSubscriptions(n.addSubscriptions) }, this.RemoveFirst = function () { return n.ThrowIfDisposed(), n.RemoveAt(0) }, this.RemoveLast = function () { return n.ThrowIfDisposed(), n.RemoveAt(n.Length() - 1) }, this.RemoveAt = function (e) { return n.ThrowIfDisposed(), n.Remove(e, 1)[0] }, this.Remove = function (e, t) { n.ThrowIfDisposed(); var r = n.list.splice(e, t); return n.TriggerSubscriptions(n.removeSubscriptions), r }, this.Clear = function () { n.ThrowIfDisposed(), n.Remove(0, n.Length()) }, this.Length = function () { return n.ThrowIfDisposed(), n.list.length }, this.OnAdded = function (e) { n.ThrowIfDisposed(); var t = n.subscriptionIdCounter++; return n.addSubscriptions[t] = e, { Detach: function () { delete n.addSubscriptions[t] } } }, this.OnRemoved = function (e) { n.ThrowIfDisposed(); var t = n.subscriptionIdCounter++; return n.removeSubscriptions[t] = e, { Detach: function () { delete n.removeSubscriptions[t] } } }, this.OnDisposed = function (e) { n.ThrowIfDisposed(); var t = n.subscriptionIdCounter++; return n.disposedSubscriptions[t] = e, { Detach: function () { delete n.disposedSubscriptions[t] } } }, this.Join = function (e) { return n.ThrowIfDisposed(), n.list.join(e) }, this.ToArray = function () { var e = Array(); return n.list.forEach(function (t) { e.push(t) }), e }, this.Any = function (e) { return n.ThrowIfDisposed(), e ? n.Where(e).Length() > 0 : n.Length() > 0 }, this.All = function (e) { return n.ThrowIfDisposed(), n.Where(e).Length() === n.Length() }, this.ForEach = function (e) { n.ThrowIfDisposed(); for (var t = 0; t < n.Length(); t++)e(n.list[t], t) }, this.Select = function (t) { n.ThrowIfDisposed(); for (var r = [], o = 0; o < n.list.length; o++)r.push(t(n.list[o], o)); return new e(r) }, this.Where = function (t) { n.ThrowIfDisposed(); for (var r = new e, o = 0; o < n.list.length; o++)t(n.list[o], o) && r.Add(n.list[o]); return r }, this.OrderBy = function (t) { return n.ThrowIfDisposed(), new e(n.ToArray().sort(t)) }, this.OrderByDesc = function (e) { return n.ThrowIfDisposed(), n.OrderBy(function (t, n) { return e(n, t) }) }, this.Clone = function () { return n.ThrowIfDisposed(), new e(n.ToArray()) }, this.Concat = function (t) { return n.ThrowIfDisposed(), new e(n.list.concat(t.ToArray())) }, this.ConcatArray = function (t) { return n.ThrowIfDisposed(), new e(n.list.concat(t)) }, this.IsDisposed = function () { return null == n.list }, this.Dispose = function (e) { n.IsDisposed() || (n.disposeReason = e, n.list = null, n.addSubscriptions = null, n.removeSubscriptions = null, n.TriggerSubscriptions(n.disposedSubscriptions)) }, this.ThrowIfDisposed = function () { if (n.IsDisposed()) throw new r.ObjectDisposedError("List", n.disposeReason) }, this.TriggerSubscriptions = function (e) { if (e) for (var t in e) t && e[t]() }, this.list = [], t) for (var o = 0, i = t; o < i.length; o++) { var s = i[o]; this.list.push(s) } } }(); t.List = o }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var r, o = n(3); !function (e) { e[e.None = 0] = "None", e[e.Resolved = 1] = "Resolved", e[e.Rejected = 2] = "Rejected" }(r = t.PromiseState || (t.PromiseState = {})); var i = function () { function e(e) { var t = this; this.ThrowIfError = function () { if (t.IsError) throw t.Error }, e.On(function (e) { t.isCompleted || (t.isCompleted = !0, t.isError = !1, t.result = e) }, function (e) { t.isCompleted || (t.isCompleted = !0, t.isError = !0, t.error = e) }) } return Object.defineProperty(e.prototype, "IsCompleted", { get: function () { return this.isCompleted }, enumerable: !0, configurable: !0 }), Object.defineProperty(e.prototype, "IsError", { get: function () { return this.isError }, enumerable: !0, configurable: !0 }), Object.defineProperty(e.prototype, "Error", { get: function () { return this.error }, enumerable: !0, configurable: !0 }), Object.defineProperty(e.prototype, "Result", { get: function () { return this.result }, enumerable: !0, configurable: !0 }), e }(); t.PromiseResult = i; var s = function () { return function () { var e = this; this.SetResult = function (t) { e.onSetResult(t) }, this.SetError = function (t) { e.onSetError(t) }, this.On = function (t, n) { e.onSetResult = t, e.onSetError = n } } }(); t.PromiseResultEventSource = s; var c = function () { function e() { } return e.WhenAll = function (e) { if (!e || 0 === e.length) throw new o.ArgumentNullError("promises"); for (var t = new u, n = [], r = 0, i = function () { ++r === e.length && (0 === n.length ? t.Resolve(!0) : t.Reject(n.join(", "))) }, s = 0, c = e; s < c.length; s++) { c[s].On(function (e) { i() }, function (e) { n.push(e), i() }) } return t.Promise() }, e.FromResult = function (e) { var t = new u; return t.Resolve(e), t.Promise() }, e.FromError = function (e) { var t = new u; return t.Reject(e), t.Promise() }, e }(); t.PromiseHelper = c; var a = function () { return function (e) { var t = this; this.Result = function () { return t.sink.Result }, this.ContinueWith = function (e) { if (!e) throw new o.ArgumentNullError("continuationCallback"); var n = new u; return t.sink.on(function (r) { try { var o = e(t.sink.Result); n.Resolve(o) } catch (e) { n.Reject(e) } }, function (r) { try { var o = e(t.sink.Result); n.Resolve(o) } catch (e) { n.Reject("'Error handler for error " + r + " threw error " + e + "'") } }), n.Promise() }, this.OnSuccessContinueWith = function (e) { if (!e) throw new o.ArgumentNullError("continuationCallback"); var n = new u; return t.sink.on(function (t) { try { var r = e(t); n.Resolve(r) } catch (e) { n.Reject(e) } }, function (e) { n.Reject(e) }), n.Promise() }, this.ContinueWithPromise = function (e) { if (!e) throw new o.ArgumentNullError("continuationCallback"); var n = new u; return t.sink.on(function (r) { try { var o = e(t.sink.Result); if (!o) throw new Error("'Continuation callback did not return promise'"); o.On(function (e) { n.Resolve(e) }, function (e) { n.Reject(e) }) } catch (e) { n.Reject(e) } }, function (r) { try { var o = e(t.sink.Result); if (!o) throw new Error("Continuation callback did not return promise"); o.On(function (e) { n.Resolve(e) }, function (e) { n.Reject(e) }) } catch (e) { n.Reject("'Error handler for error " + r + " threw error " + e + "'") } }), n.Promise() }, this.OnSuccessContinueWithPromise = function (e) { if (!e) throw new o.ArgumentNullError("continuationCallback"); var n = new u; return t.sink.on(function (t) { try { var r = e(t); if (!r) throw new Error("Continuation callback did not return promise"); r.On(function (e) { n.Resolve(e) }, function (e) { n.Reject(e) }) } catch (e) { n.Reject(e) } }, function (e) { n.Reject(e) }), n.Promise() }, this.On = function (e, n) { if (!e) throw new o.ArgumentNullError("successCallback"); if (!n) throw new o.ArgumentNullError("errorCallback"); return t.sink.on(e, n), t }, this.Finally = function (e) { if (!e) throw new o.ArgumentNullError("callback"); var n = function (t) { e() }; return t.On(n, n) }, this.sink = e } }(); t.Promise = a; var u = function () { return function () { var e = this; this.State = function () { return e.sink.State }, this.Promise = function () { return e.promise }, this.Resolve = function (t) { return e.sink.Resolve(t), e }, this.Reject = function (t) { return e.sink.Reject(t), e }, this.sink = new p, this.promise = new a(this.sink) } }(); t.Deferred = u; var p = function () { function e() { var e = this; this.state = r.None, this.promiseResult = null, this.promiseResultEvents = null, this.successHandlers = [], this.errorHandlers = [], this.Resolve = function (t) { if (e.state !== r.None) throw new Error("'Cannot resolve a completed promise'"); e.state = r.Resolved, e.promiseResultEvents.SetResult(t); for (var n = 0; n < e.successHandlers.length; n++)e.ExecuteSuccessCallback(t, e.successHandlers[n], e.errorHandlers[n]); e.DetachHandlers() }, this.Reject = function (t) { if (e.state !== r.None) throw new Error("'Cannot reject a completed promise'"); e.state = r.Rejected, e.promiseResultEvents.SetError(t); for (var n = 0, o = e.errorHandlers; n < o.length; n++) { var i = o[n]; e.ExecuteErrorCallback(t, i) } e.DetachHandlers() }, this.on = function (t, n) { null == t && (t = function (e) { }), e.state === r.None ? (e.successHandlers.push(t), e.errorHandlers.push(n)) : (e.state === r.Resolved ? e.ExecuteSuccessCallback(e.promiseResult.Result, t, n) : e.state === r.Rejected && e.ExecuteErrorCallback(e.promiseResult.Error, n), e.DetachHandlers()) }, this.ExecuteSuccessCallback = function (t, n, r) { try { n(t) } catch (t) { e.ExecuteErrorCallback("'Unhandled callback error: " + t + "'", r) } }, this.ExecuteErrorCallback = function (e, t) { if (!t) throw new Error("'Unhandled error: " + e + "'"); try { t(e) } catch (t) { throw new Error("'Unhandled callback error: " + t + ". InnerError: " + e + "'") } }, this.DetachHandlers = function () { e.errorHandlers = [], e.successHandlers = [] }, this.promiseResultEvents = new s, this.promiseResult = new i(this.promiseResultEvents) } return Object.defineProperty(e.prototype, "State", { get: function () { return this.state }, enumerable: !0, configurable: !0 }), Object.defineProperty(e.prototype, "Result", { get: function () { return this.promiseResult }, enumerable: !0, configurable: !0 }), e }(); t.Sink = p }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var r, o = n(3), i = n(14), s = n(15); !function (e) { e[e.Dequeue = 0] = "Dequeue", e[e.Peek = 1] = "Peek" }(r || (r = {})); var c = function () { return function (e) { var t = this; this.promiseStore = new i.List, this.isDrainInProgress = !1, this.isDisposing = !1, this.disposeReason = null, this.Enqueue = function (e) { t.ThrowIfDispose(), t.EnqueueFromPromise(s.PromiseHelper.FromResult(e)) }, this.EnqueueFromPromise = function (e) { t.ThrowIfDispose(), t.promiseStore.Add(e), e.Finally(function () { for (; t.promiseStore.Length() > 0 && t.promiseStore.First().Result().IsCompleted;) { var e = t.promiseStore.RemoveFirst(); e.Result().IsError || t.list.Add(e.Result().Result) } }) }, this.Dequeue = function () { t.ThrowIfDispose(); var e = new s.Deferred; return t.subscribers && (t.subscribers.Add({ deferral: e, type: r.Dequeue }), t.Drain()), e.Promise() }, this.Peek = function () { t.ThrowIfDispose(); var e = new s.Deferred; return t.subscribers && (t.subscribers.Add({ deferral: e, type: r.Peek }), t.Drain()), e.Promise() }, this.Length = function () { return t.ThrowIfDispose(), t.list.Length() }, this.IsDisposed = function () { return null == t.subscribers }, this.DrainAndDispose = function (e, n) { if (!t.IsDisposed() && !t.isDisposing) { t.disposeReason = n, t.isDisposing = !0; var r = t.subscribers; if (r) { for (; r.Length() > 0;)r.RemoveFirst().deferral.Resolve(void 0); t.subscribers === r && (t.subscribers = r) } for (var o = 0, i = t.detachables; o < i.length; o++)i[o].Detach(); if (t.promiseStore.Length() > 0 && e) return s.PromiseHelper.WhenAll(t.promiseStore.ToArray()).ContinueWith(function () { return t.subscribers = null, t.list.ForEach(function (t, n) { e(t) }), t.list = null, !0 }); t.subscribers = null, t.list = null } return s.PromiseHelper.FromResult(!0) }, this.Dispose = function (e) { t.DrainAndDispose(null, e) }, this.Drain = function () { if (!t.isDrainInProgress && !t.isDisposing) { t.isDrainInProgress = !0; var e = t.subscribers, n = t.list; if (e && n) { for (; n.Length() > 0 && e.Length() > 0 && !t.isDisposing;) { var o = e.RemoveFirst(); if (o.type === r.Peek) o.deferral.Resolve(n.First()); else { var i = n.RemoveFirst(); o.deferral.Resolve(i) } } t.subscribers === e && (t.subscribers = e), t.list === n && (t.list = n) } t.isDrainInProgress = !1 } }, this.ThrowIfDispose = function () { if (t.IsDisposed()) { if (t.disposeReason) throw new o.InvalidOperationError(t.disposeReason); throw new o.ObjectDisposedError("Queue") } if (t.isDisposing) throw new o.InvalidOperationError("Queue disposing") }, this.list = e || new i.List, this.detachables = [], this.subscribers = new i.List, this.detachables.push(this.list.OnAdded(this.Drain)) } }(); t.Queue = c }, function (e, t, n) { "use strict"; var r, o = this && this.__extends || (r = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (e, t) { e.__proto__ = t } || function (e, t) { for (var n in t) t.hasOwnProperty(n) && (e[n] = t[n]) }, function (e, t) { function n() { this.constructor = e } r(e, t), e.prototype = null === t ? Object.create(t) : (n.prototype = t.prototype, new n) }); Object.defineProperty(t, "__esModule", { value: !0 }); var i = n(5), s = n(1), c = n(0), a = n(18), u = function () { function e() { } return e.createPushStream = function (e) { return p.create(e) }, e.createPullStream = function (e, t) { return f.create(e, t) }, e }(); t.AudioInputStream = u; var p = function (e) { function t() { return null !== e && e.apply(this, arguments) || this } return o(t, e), t.create = function (e) { return new l(e) }, t }(u); t.PushAudioInputStream = p; var l = function (e) { function t(t) { var n = e.call(this) || this; return n.stream = new s.Stream, n.OnEvent = function (e) { n.events.OnEvent(e), s.Events.Instance.OnEvent(e) }, n.format = void 0 === t ? a.AudioStreamFormatImpl.getDefaultInputFormat() : t, n.events = new s.EventSource, n.id = i.CreateNoDashGuid(), n } return o(t, e), Object.defineProperty(t.prototype, "Format", { get: function () { return this.format }, enumerable: !0, configurable: !0 }), t.prototype.write = function (e) { var t; for (t = 4095; t < e.byteLength; t += 4096)this.stream.Write(e.slice(t - 4095, t + 1)); t - 4095 !== e.byteLength && this.stream.Write(e.slice(t - 4095, e.byteLength)) }, t.prototype.close = function () { this.stream.Close() }, t.prototype.Id = function () { return this.id }, t.prototype.TurnOn = function () { return this.OnEvent(new s.AudioSourceInitializingEvent(this.id)), this.OnEvent(new s.AudioSourceReadyEvent(this.id)), s.PromiseHelper.FromResult(!0) }, t.prototype.Attach = function (e) { var t = this; return this.OnEvent(new s.AudioStreamNodeAttachingEvent(this.id, e)), this.TurnOn().OnSuccessContinueWith(function (e) { return t.stream.GetReader() }).OnSuccessContinueWith(function (n) { return t.OnEvent(new s.AudioStreamNodeAttachedEvent(t.id, e)), { Detach: function () { n.Close(), t.OnEvent(new s.AudioStreamNodeDetachedEvent(t.id, e)), t.TurnOff() }, Id: function () { return e }, Read: function () { return n.Read() } } }) }, t.prototype.Detach = function (e) { this.OnEvent(new s.AudioStreamNodeDetachedEvent(this.id, e)) }, t.prototype.TurnOff = function () { return s.PromiseHelper.FromResult(!1) }, Object.defineProperty(t.prototype, "Events", { get: function () { return this.events }, enumerable: !0, configurable: !0 }), t }(p); t.PushAudioInputStreamImpl = l; var f = function (e) { function t() { return e.call(this) || this } return o(t, e), t.create = function (e, t) { return new d(e, t) }, t }(u); t.PullAudioInputStream = f; var d = function (e) { function t(t, n) { var r = e.call(this) || this; return r.OnEvent = function (e) { r.events.OnEvent(e), s.Events.Instance.OnEvent(e) }, r.format = void 0 === n ? c.AudioStreamFormat.getDefaultInputFormat() : n, r.events = new s.EventSource, r.id = i.CreateNoDashGuid(), r.callback = t, r.isClosed = !1, r } return o(t, e), Object.defineProperty(t.prototype, "Format", { get: function () { return this.format }, enumerable: !0, configurable: !0 }), t.prototype.close = function () { this.isClosed = !0, this.callback.close() }, t.prototype.Id = function () { return this.id }, t.prototype.TurnOn = function () { return this.OnEvent(new s.AudioSourceInitializingEvent(this.id)), this.OnEvent(new s.AudioSourceReadyEvent(this.id)), s.PromiseHelper.FromResult(!0) }, t.prototype.Attach = function (e) { var t = this; return this.OnEvent(new s.AudioStreamNodeAttachingEvent(this.id, e)), this.TurnOn().OnSuccessContinueWith(function (n) { return t.OnEvent(new s.AudioStreamNodeAttachedEvent(t.id, e)), { Detach: function () { t.callback.close(), t.OnEvent(new s.AudioStreamNodeDetachedEvent(t.id, e)), t.TurnOff() }, Id: function () { return e }, Read: function () { var e = new ArrayBuffer(4096), n = t.callback.read(e); return s.PromiseHelper.FromResult({ Buffer: e.slice(0, n), IsEnd: t.isClosed }) } } }) }, t.prototype.Detach = function (e) { this.OnEvent(new s.AudioStreamNodeDetachedEvent(this.id, e)) }, t.prototype.TurnOff = function () { return s.PromiseHelper.FromResult(!1) }, Object.defineProperty(t.prototype, "Events", { get: function () { return this.events }, enumerable: !0, configurable: !0 }), t }(f); t.PullAudioInputStreamImpl = d }, function (e, t, n) { "use strict"; var r, o = this && this.__extends || (r = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (e, t) { e.__proto__ = t } || function (e, t) { for (var n in t) t.hasOwnProperty(n) && (e[n] = t[n]) }, function (e, t) { function n() { this.constructor = e } r(e, t), e.prototype = null === t ? Object.create(t) : (n.prototype = t.prototype, new n) }); Object.defineProperty(t, "__esModule", { value: !0 }); var i = function () { function e() { } return e.getDefaultInputFormat = function () { return s.getDefaultInputFormat() }, e.getWaveFormatPCM = function (e, t, n) { return new s(e, t, n) }, e }(); t.AudioStreamFormat = i; var s = function (e) { function t(t, n, r) { void 0 === t && (t = 16e3), void 0 === n && (n = 16), void 0 === r && (r = 1); var o = e.call(this) || this; return o.formatTag = 1, o.bitsPerSample = n, o.samplesPerSec = t, o.channels = r, o.avgBytesPerSec = o.samplesPerSec * o.channels * (o.bitsPerSample / 8), o.blockAlign = o.channels * Math.max(o.bitsPerSample, 8), o } return o(t, e), t.getDefaultInputFormat = function () { return new t }, t.prototype.close = function () { }, t }(i); t.AudioStreamFormatImpl = s }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var r = n(6), o = n(2), i = n(1), s = n(0), c = n(2), a = n(62), u = function () { function e() { var e = this; this.Create = function (t, n, i) { var u = t.parameters.getProperty(s.PropertyId.SpeechServiceConnection_Endpoint, void 0), p = {}, l = t.parameters.getProperty(s.PropertyId.SpeechServiceConnection_EndpointId, void 0), f = t.parameters.getProperty(s.PropertyId.SpeechServiceConnection_RecoLanguage, void 0); if (l ? u && -1 !== u.search(a.QueryParameterNames.DeploymentIdParamName) || (p[a.QueryParameterNames.DeploymentIdParamName] = l) : f && (u && -1 !== u.search(a.QueryParameterNames.LanguageParamName) || (p[a.QueryParameterNames.LanguageParamName] = f)), u && -1 !== u.search(a.QueryParameterNames.FormatParamName) || (p[a.QueryParameterNames.FormatParamName] = t.parameters.getProperty(o.OutputFormatPropertyName, s.OutputFormat[s.OutputFormat.Simple]).toLowerCase()), e.IsDebugModeEnabled && (p[a.QueryParameterNames.TestHooksParamName] = "1"), !u) { var d = t.parameters.getProperty(s.PropertyId.SpeechServiceConnection_Region, void 0); switch (t.RecognitionMode) { case c.RecognitionMode.Conversation: u = e.Host(d) + e.ConversationRelativeUri; break; case c.RecognitionMode.Dictation: u = e.Host(d) + e.DictationRelativeUri; break; default: u = e.Host(d) + e.InteractiveRelativeUri } } var h = {}; return h[n.HeaderName] = n.Token, h[a.QueryParameterNames.ConnectionIdHeader] = i, new r.WebsocketConnection(u, p, h, new c.WebsocketMessageFormatter, i) } } return e.prototype.Host = function (e) { return i.Storage.Local.GetOrAdd("Host", "wss://" + e + ".stt.speech.microsoft.com") }, Object.defineProperty(e.prototype, "InteractiveRelativeUri", { get: function () { return i.Storage.Local.GetOrAdd("InteractiveRelativeUri", "/speech/recognition/interactive/cognitiveservices/v1") }, enumerable: !0, configurable: !0 }), Object.defineProperty(e.prototype, "ConversationRelativeUri", { get: function () { return i.Storage.Local.GetOrAdd("ConversationRelativeUri", "/speech/recognition/conversation/cognitiveservices/v1") }, enumerable: !0, configurable: !0 }), Object.defineProperty(e.prototype, "DictationRelativeUri", { get: function () { return i.Storage.Local.GetOrAdd("DictationRelativeUri", "/speech/recognition/dictation/cognitiveservices/v1") }, enumerable: !0, configurable: !0 }), Object.defineProperty(e.prototype, "IsDebugModeEnabled", { get: function () { return "true" === i.Storage.Local.GetOrAdd("IsDebugModeEnabled", "false").toLowerCase() }, enumerable: !0, configurable: !0 }), e }(); t.SpeechConnectionFactory = u }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var r = n(1), o = function () { function e(e, t, n) { var o = this; if (this.Open = function () { if (o.connectionState === r.ConnectionState.Disconnected) return r.PromiseHelper.FromError("Cannot open a connection that is in " + o.connectionState + " state"); if (o.connectionEstablishDeferral) return o.connectionEstablishDeferral.Promise(); o.connectionEstablishDeferral = new r.Deferred, o.connectionState = r.ConnectionState.Connecting; try { o.websocketClient = new WebSocket(o.uri), o.websocketClient.binaryType = "arraybuffer", o.receivingMessageQueue = new r.Queue, o.disconnectDeferral = new r.Deferred, o.sendMessageQueue = new r.Queue, o.ProcessSendQueue() } catch (e) { return o.connectionEstablishDeferral.Resolve(new r.ConnectionOpenResponse(500, e)), o.connectionEstablishDeferral.Promise() } return o.OnEvent(new r.ConnectionStartEvent(o.connectionId, o.uri)), o.websocketClient.onopen = function (e) { o.connectionState = r.ConnectionState.Connected, o.OnEvent(new r.ConnectionEstablishedEvent(o.connectionId)), o.connectionEstablishDeferral.Resolve(new r.ConnectionOpenResponse(200, "")) }, o.websocketClient.onerror = function (e) { o.connectionState, r.ConnectionState.Connecting }, o.websocketClient.onclose = function (e) { o.connectionState === r.ConnectionState.Connecting ? (o.connectionState = r.ConnectionState.Disconnected, o.connectionEstablishDeferral.Resolve(new r.ConnectionOpenResponse(e.code, e.reason))) : o.OnEvent(new r.ConnectionClosedEvent(o.connectionId, e.code, e.reason)), o.OnClose(e.code, e.reason) }, o.websocketClient.onmessage = function (e) { var t = (new Date).toISOString(); if (o.connectionState === r.ConnectionState.Connected) { var n = new r.Deferred; if (o.receivingMessageQueue.EnqueueFromPromise(n.Promise()), e.data instanceof ArrayBuffer) { var i = new r.RawWebsocketMessage(r.MessageType.Binary, e.data); o.messageFormatter.ToConnectionMessage(i).On(function (e) { o.OnEvent(new r.ConnectionMessageReceivedEvent(o.connectionId, t, e)), n.Resolve(e) }, function (e) { n.Reject("Invalid binary message format. Error: " + e) }) } else { i = new r.RawWebsocketMessage(r.MessageType.Text, e.data); o.messageFormatter.ToConnectionMessage(i).On(function (e) { o.OnEvent(new r.ConnectionMessageReceivedEvent(o.connectionId, t, e)), n.Resolve(e) }, function (e) { n.Reject("Invalid text message format. Error: " + e) }) } } }, o.connectionEstablishDeferral.Promise() }, this.Send = function (e) { if (o.connectionState !== r.ConnectionState.Connected) return r.PromiseHelper.FromError("Cannot send on connection that is in " + o.connectionState + " state"); var t = new r.Deferred, n = new r.Deferred; return o.sendMessageQueue.EnqueueFromPromise(n.Promise()), o.messageFormatter.FromConnectionMessage(e).On(function (r) { n.Resolve({ Message: e, RawWebsocketMessage: r, SendStatusDeferral: t }) }, function (e) { n.Reject("Error formatting the message. " + e) }), t.Promise() }, this.Read = function () { return o.connectionState !== r.ConnectionState.Connected ? r.PromiseHelper.FromError("Cannot read on connection that is in " + o.connectionState + " state") : o.receivingMessageQueue.Dequeue() }, this.Close = function (e) { if (!o.websocketClient) { var t = new r.Deferred; return t.Resolve(!0), t.Promise() } return o.connectionState !== r.ConnectionState.Disconnected && o.websocketClient.close(1e3, e || "Normal closure by client"), o.disconnectDeferral.Promise() }, this.SendRawMessage = function (e) { try { return e ? (o.OnEvent(new r.ConnectionMessageSentEvent(o.connectionId, (new Date).toISOString(), e.Message)), o.websocketClient.send(e.RawWebsocketMessage.Payload), r.PromiseHelper.FromResult(!0)) : r.PromiseHelper.FromResult(!0) } catch (e) { return r.PromiseHelper.FromError("websocket send error: " + e) } }, this.OnClose = function (e, t) { var n = "Connection closed. " + e + ": " + t; o.connectionState = r.ConnectionState.Disconnected, o.disconnectDeferral.Resolve(!0), o.receivingMessageQueue.Dispose(t), o.receivingMessageQueue.DrainAndDispose(function (e) { }, n), o.sendMessageQueue.DrainAndDispose(function (e) { e.SendStatusDeferral.Reject(n) }, n) }, this.ProcessSendQueue = function () { o.sendMessageQueue.Dequeue().On(function (e) { e && o.SendRawMessage(e).On(function (t) { e.SendStatusDeferral.Resolve(t), o.ProcessSendQueue() }, function (t) { e.SendStatusDeferral.Reject(t), o.ProcessSendQueue() }) }, function (e) { }) }, this.OnEvent = function (e) { o.connectionEvents.OnEvent(e), r.Events.Instance.OnEvent(e) }, !e) throw new r.ArgumentNullError("uri"); if (!n) throw new r.ArgumentNullError("messageFormatter"); this.connectionEvents = new r.EventSource, this.connectionId = t, this.messageFormatter = n, this.connectionState = r.ConnectionState.None, this.uri = e } return Object.defineProperty(e.prototype, "State", { get: function () { return this.connectionState }, enumerable: !0, configurable: !0 }), Object.defineProperty(e.prototype, "Events", { get: function () { return this.connectionEvents }, enumerable: !0, configurable: !0 }), e }(); t.WebsocketMessageAdapter = o }, function (e, t, n) { window.SpeechSDK = n(22) }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var r = n(6); n(1).Events.Instance.AttachListener(new r.ConsoleLoggingListener), function (e) { for (var n in e) t.hasOwnProperty(n) || (t[n] = e[n]) }(n(0)) }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var r = n(1), o = function () { return function (e) { void 0 === e && (e = r.EventType.Warning); var t = this; this.OnEvent = function (e) { if (e.EventType >= t.logLevelFilter) { var n = t.ToString(e); switch (e.EventType) { case r.EventType.Debug: console.debug(n); break; case r.EventType.Info: console.info(n); break; case r.EventType.Warning: console.warn(n); break; case r.EventType.Error: console.error(n); break; default: console.log(n) } } }, this.ToString = function (e) { var t = ["" + e.EventTime, "" + e.Name]; for (var n in e) if (n && e.hasOwnProperty(n) && "eventTime" !== n && "eventType" !== n && "eventId" !== n && "name" !== n && "constructor" !== n) { var r = e[n], o = "<NULL>"; null != r && (o = "number" == typeof r || "string" == typeof r ? r.toString() : JSON.stringify(r)), t.push(n + ": " + o) } return t.join(" | ") }, this.logLevelFilter = e } }(); t.ConsoleLoggingListener = o }, function (e, t, n) { "use strict"; var r, o = this && this.__extends || (r = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (e, t) { e.__proto__ = t } || function (e, t) { for (var n in t) t.hasOwnProperty(n) && (e[n] = t[n]) }, function (e, t) { function n() { this.constructor = e } r(e, t), e.prototype = null === t ? Object.create(t) : (n.prototype = t.prototype, new n) }); Object.defineProperty(t, "__esModule", { value: !0 }); var i = n(7), s = function (e) { function t(t, n, r) { void 0 === r && (r = i.EventType.Info); var o = e.call(this, t, r) || this; return o.audioSourceId = n, o } return o(t, e), Object.defineProperty(t.prototype, "AudioSourceId", { get: function () { return this.audioSourceId }, enumerable: !0, configurable: !0 }), t }(i.PlatformEvent); t.AudioSourceEvent = s; var c = function (e) { function t(t) { return e.call(this, "AudioSourceInitializingEvent", t) || this } return o(t, e), t }(s); t.AudioSourceInitializingEvent = c; var a = function (e) { function t(t) { return e.call(this, "AudioSourceReadyEvent", t) || this } return o(t, e), t }(s); t.AudioSourceReadyEvent = a; var u = function (e) { function t(t) { return e.call(this, "AudioSourceOffEvent", t) || this } return o(t, e), t }(s); t.AudioSourceOffEvent = u; var p = function (e) { function t(t, n) { var r = e.call(this, "AudioSourceErrorEvent", t, i.EventType.Error) || this; return r.error = n, r } return o(t, e), Object.defineProperty(t.prototype, "Error", { get: function () { return this.error }, enumerable: !0, configurable: !0 }), t }(s); t.AudioSourceErrorEvent = p; var l = function (e) { function t(t, n, r) { var o = e.call(this, t, n) || this; return o.audioNodeId = r, o } return o(t, e), Object.defineProperty(t.prototype, "AudioNodeId", { get: function () { return this.audioNodeId }, enumerable: !0, configurable: !0 }), t }(s); t.AudioStreamNodeEvent = l; var f = function (e) { function t(t, n) { return e.call(this, "AudioStreamNodeAttachingEvent", t, n) || this } return o(t, e), t }(l); t.AudioStreamNodeAttachingEvent = f; var d = function (e) { function t(t, n) { return e.call(this, "AudioStreamNodeAttachedEvent", t, n) || this } return o(t, e), t }(l); t.AudioStreamNodeAttachedEvent = d; var h = function (e) { function t(t, n) { return e.call(this, "AudioStreamNodeDetachedEvent", t, n) || this } return o(t, e), t }(l); t.AudioStreamNodeDetachedEvent = h; var g = function (e) { function t(t, n, r) { var o = e.call(this, "AudioStreamNodeErrorEvent", t, n) || this; return o.error = r, o } return o(t, e), Object.defineProperty(t.prototype, "Error", { get: function () { return this.error }, enumerable: !0, configurable: !0 }), t }(l); t.AudioStreamNodeErrorEvent = g }, function (e, t, n) { "use strict"; var r, o = this && this.__extends || (r = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (e, t) { e.__proto__ = t } || function (e, t) { for (var n in t) t.hasOwnProperty(n) && (e[n] = t[n]) }, function (e, t) { function n() { this.constructor = e } r(e, t), e.prototype = null === t ? Object.create(t) : (n.prototype = t.prototype, new n) }); Object.defineProperty(t, "__esModule", { value: !0 }); var i = n(7), s = function (e) { function t(t, n, r) { void 0 === r && (r = i.EventType.Info); var o = e.call(this, t, r) || this; return o.connectionId = n, o } return o(t, e), Object.defineProperty(t.prototype, "ConnectionId", { get: function () { return this.connectionId }, enumerable: !0, configurable: !0 }), t }(i.PlatformEvent); t.ConnectionEvent = s; var c = function (e) { function t(t, n, r) { var o = e.call(this, "ConnectionStartEvent", t) || this; return o.uri = n, o.headers = r, o } return o(t, e), Object.defineProperty(t.prototype, "Uri", { get: function () { return this.uri }, enumerable: !0, configurable: !0 }), Object.defineProperty(t.prototype, "Headers", { get: function () { return this.headers }, enumerable: !0, configurable: !0 }), t }(s); t.ConnectionStartEvent = c; var a = function (e) { function t(t, n) { return e.call(this, "ConnectionEstablishedEvent", t) || this } return o(t, e), t }(s); t.ConnectionEstablishedEvent = a; var u = function (e) { function t(t, n, r) { var o = e.call(this, "ConnectionClosedEvent", t, i.EventType.Debug) || this; return o.reason = r, o.statusCode = n, o } return o(t, e), Object.defineProperty(t.prototype, "Reason", { get: function () { return this.reason }, enumerable: !0, configurable: !0 }), Object.defineProperty(t.prototype, "StatusCode", { get: function () { return this.statusCode }, enumerable: !0, configurable: !0 }), t }(s); t.ConnectionClosedEvent = u; var p = function (e) { function t(t, n, r) { var o = e.call(this, "ConnectionEstablishErrorEvent", t, i.EventType.Error) || this; return o.statusCode = n, o.reason = r, o } return o(t, e), Object.defineProperty(t.prototype, "Reason", { get: function () { return this.reason }, enumerable: !0, configurable: !0 }), Object.defineProperty(t.prototype, "StatusCode", { get: function () { return this.statusCode }, enumerable: !0, configurable: !0 }), t }(s); t.ConnectionEstablishErrorEvent = p; var l = function (e) { function t(t, n, r) { var o = e.call(this, "ConnectionMessageReceivedEvent", t) || this; return o.networkReceivedTime = n, o.message = r, o } return o(t, e), Object.defineProperty(t.prototype, "NetworkReceivedTime", { get: function () { return this.networkReceivedTime }, enumerable: !0, configurable: !0 }), Object.defineProperty(t.prototype, "Message", { get: function () { return this.message }, enumerable: !0, configurable: !0 }), t }(s); t.ConnectionMessageReceivedEvent = l; var f = function (e) { function t(t, n, r) { var o = e.call(this, "ConnectionMessageSentEvent", t) || this; return o.networkSentTime = n, o.message = r, o } return o(t, e), Object.defineProperty(t.prototype, "NetworkSentTime", { get: function () { return this.networkSentTime }, enumerable: !0, configurable: !0 }), Object.defineProperty(t.prototype, "Message", { get: function () { return this.message }, enumerable: !0, configurable: !0 }), t }(s); t.ConnectionMessageSentEvent = f }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var r = function () { function e(e, t) { this.statusCode = e, this.reason = t } return Object.defineProperty(e.prototype, "StatusCode", { get: function () { return this.statusCode }, enumerable: !0, configurable: !0 }), Object.defineProperty(e.prototype, "Reason", { get: function () { return this.reason }, enumerable: !0, configurable: !0 }), e }(); t.ConnectionOpenResponse = r }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var r = n(3), o = n(12), i = function () { function e() { } return Object.defineProperty(e, "Instance", { get: function () { return e.instance }, enumerable: !0, configurable: !0 }), e.instance = new o.EventSource, e.SetEventSource = function (t) { if (!t) throw new r.ArgumentNullError("eventSource"); e.instance = t }, e }(); t.Events = i }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }), function (e) { e[e.None = 0] = "None", e[e.Connected = 1] = "Connected", e[e.Connecting = 2] = "Connecting", e[e.Disconnected = 3] = "Disconnected" }(t.ConnectionState || (t.ConnectionState = {})) }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var r = n(11), o = n(3), i = n(5), s = function () { function e(e, t, n) { if (this.payload = null, !t) throw new o.ArgumentNullError("payload"); if (e === r.MessageType.Binary && !(t instanceof ArrayBuffer)) throw new o.InvalidOperationError("Payload must be ArrayBuffer"); if (e === r.MessageType.Text && "string" != typeof t) throw new o.InvalidOperationError("Payload must be a string"); this.messageType = e, this.payload = t, this.id = n || i.CreateNoDashGuid() } return Object.defineProperty(e.prototype, "MessageType", { get: function () { return this.messageType }, enumerable: !0, configurable: !0 }), Object.defineProperty(e.prototype, "Payload", { get: function () { return this.payload }, enumerable: !0, configurable: !0 }), Object.defineProperty(e.prototype, "TextContent", { get: function () { if (this.messageType === r.MessageType.Binary) throw new o.InvalidOperationError("Not supported for binary message"); return this.payload }, enumerable: !0, configurable: !0 }), Object.defineProperty(e.prototype, "BinaryContent", { get: function () { if (this.messageType === r.MessageType.Text) throw new o.InvalidOperationError("Not supported for text message"); return this.payload }, enumerable: !0, configurable: !0 }), Object.defineProperty(e.prototype, "Id", { get: function () { return this.id }, enumerable: !0, configurable: !0 }), e }(); t.RawWebsocketMessage = s }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var r = function () { return function (e, t) { var n = this; this.channelCount = 1, this.Encode = function (e, t) { var r = n.DownSampleAudioFrame(t, n.actualSampleRate, n.desiredSampleRate); if (!r) return null; var o = 2 * r.length; if (!e) { var i = new ArrayBuffer(o), s = new DataView(i); return n.FloatTo16BitPCM(s, 0, r), i } var c = new ArrayBuffer(44 + o), a = new DataView(c); return n.SetString(a, 0, "RIFF"), a.setUint32(4, 0, !0), n.SetString(a, 8, "WAVEfmt "), a.setUint32(16, 16, !0), a.setUint16(20, 1, !0), a.setUint16(22, n.channelCount, !0), a.setUint32(24, n.desiredSampleRate, !0), a.setUint32(28, n.desiredSampleRate * n.channelCount * 2, !0), a.setUint16(32, 2 * n.channelCount, !0), a.setUint16(34, 16, !0), n.SetString(a, 36, "data"), a.setUint32(40, 0, !0), n.FloatTo16BitPCM(a, 44, r), c }, this.SetString = function (e, t, n) { for (var r = 0; r < n.length; r++)e.setUint8(t + r, n.charCodeAt(r)) }, this.FloatTo16BitPCM = function (e, t, n) { for (var r = 0; r < n.length; r++ , t += 2) { var o = Math.max(-1, Math.min(1, n[r])); e.setInt16(t, o < 0 ? 32768 * o : 32767 * o, !0) } }, this.DownSampleAudioFrame = function (e, t, n) { if (n === t || n > t) return e; for (var r = t / n, o = Math.round(e.length / r), i = new Float32Array(o), s = 0, c = 0; c < o;) { for (var a = Math.round((c + 1) * r), u = 0, p = 0; s < a && s < e.length;)u += e[s++], p++; i[c++] = u / p } return i }, this.actualSampleRate = e, this.desiredSampleRate = t } }(); t.RiffPcmEncoder = r }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var r = n(3), o = n(13), i = function () { function e() { } return Object.defineProperty(e, "Session", { get: function () { return e.sessionStorage }, enumerable: !0, configurable: !0 }), Object.defineProperty(e, "Local", { get: function () { return e.localStorage }, enumerable: !0, configurable: !0 }), e.sessionStorage = new o.InMemoryStorage, e.localStorage = new o.InMemoryStorage, e.SetSessionStorage = function (t) { if (!t) throw new r.ArgumentNullError("sessionStorage"); e.sessionStorage = t }, e.SetLocalStorage = function (t) { if (!t) throw new r.ArgumentNullError("localStorage"); e.localStorage = t }, e }(); t.Storage = i }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var r = n(3), o = n(5), i = n(16), s = function () { function e(e) { var t = this; this.readerIdCounter = 1, this.isEnded = !1, this.Write = function (e) { t.ThrowIfClosed(), t.WriteStreamChunk({ Buffer: e, IsEnd: !1 }) }, this.GetReader = function () { var e = t.readerIdCounter; t.readerIdCounter++; var n = new i.Queue, r = t.streambuffer.length; t.readerQueues[e] = n; for (var o = 0; o < r; o++)n.Enqueue(t.streambuffer[o]); return new c(t.id, n, function () { delete t.readerQueues[e] }) }, this.Close = function () { t.isEnded || (t.WriteStreamChunk({ Buffer: null, IsEnd: !0 }), t.isEnded = !0) }, this.WriteStreamChunk = function (e) { for (var n in t.ThrowIfClosed(), t.streambuffer.push(e), t.readerQueues) if (!t.readerQueues[n].IsDisposed()) try { t.readerQueues[n].Enqueue(e) } catch (e) { } }, this.ThrowIfClosed = function () { if (t.isEnded) throw new r.InvalidOperationError("Stream closed") }, this.id = e || o.CreateNoDashGuid(), this.streambuffer = [], this.readerQueues = {} } return Object.defineProperty(e.prototype, "IsClosed", { get: function () { return this.isEnded }, enumerable: !0, configurable: !0 }), Object.defineProperty(e.prototype, "Id", { get: function () { return this.id }, enumerable: !0, configurable: !0 }), e }(); t.Stream = s; var c = function () { function e(e, t, n) { var o = this; this.isClosed = !1, this.Read = function () { if (o.IsClosed) throw new r.InvalidOperationError("StreamReader closed"); return o.readerQueue.Dequeue().OnSuccessContinueWith(function (e) { return e.IsEnd && o.readerQueue.Dispose("End of stream reached"), e }) }, this.Close = function () { o.isClosed || (o.isClosed = !0, o.readerQueue.Dispose("StreamReader closed"), o.onClose()) }, this.readerQueue = t, this.onClose = n, this.streamId = e } return Object.defineProperty(e.prototype, "IsClosed", { get: function () { return this.isClosed }, enumerable: !0, configurable: !0 }), Object.defineProperty(e.prototype, "StreamId", { get: function () { return this.streamId }, enumerable: !0, configurable: !0 }), e }(); t.StreamReader = c }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var r = n(1), o = function () { return function () { this.Get = function (e) { if (!e) throw new r.ArgumentNullError("key"); return localStorage.getItem(e) }, this.GetOrAdd = function (e, t) { if (!e) throw new r.ArgumentNullError("key"); var n = localStorage.getItem(e); return null == n && localStorage.setItem(e, t), localStorage.getItem(e) }, this.Set = function (e, t) { if (!e) throw new r.ArgumentNullError("key"); localStorage.setItem(e, t) }, this.Remove = function (e) { if (!e) throw new r.ArgumentNullError("key"); localStorage.removeItem(e) } } }(); t.LocalStorage = o }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var r = n(0), o = n(1), i = function () { function e(e, t) { var n = this; this.streams = {}, this.TurnOn = function () { if (n.initializeDeferral) return n.initializeDeferral.Promise(); n.initializeDeferral = new o.Deferred, n.CreateAudioContext(); var e = window.navigator, t = e.getUserMedia || e.webkitGetUserMedia || e.mozGetUserMedia || e.msGetUserMedia; if (e.mediaDevices && (t = function (t, n, r) { e.mediaDevices.getUserMedia(t).then(n).catch(r) }), t) { var r = function () { n.OnEvent(new o.AudioSourceInitializingEvent(n.id)), t({ audio: !0, video: !1 }, function (e) { n.mediaStream = e, n.OnEvent(new o.AudioSourceReadyEvent(n.id)), n.initializeDeferral.Resolve(!0) }, function (e) { var t = "Error occurred during microphone initialization: " + e, r = n.initializeDeferral; n.initializeDeferral = null, r.Reject(t), n.OnEvent(new o.AudioSourceErrorEvent(n.id, t)) }) }; "suspended" === n.context.state ? n.context.resume().then(r, function (e) { n.initializeDeferral.Reject("Failed to initialize audio context: " + e) }) : r() } else { var i = "Browser does not support getUserMedia."; n.initializeDeferral.Reject(i), n.OnEvent(new o.AudioSourceErrorEvent(i, "")) } return n.initializeDeferral.Promise() }, this.Id = function () { return n.id }, this.Attach = function (e) { return n.OnEvent(new o.AudioStreamNodeAttachingEvent(n.id, e)), n.Listen(e).OnSuccessContinueWith(function (t) { return n.OnEvent(new o.AudioStreamNodeAttachedEvent(n.id, e)), { Detach: function () { t.Close(), delete n.streams[e], n.OnEvent(new o.AudioStreamNodeDetachedEvent(n.id, e)), n.TurnOff() }, Id: function () { return e }, Read: function () { return t.Read() } } }) }, this.Detach = function (e) { e && n.streams[e] && (n.streams[e].Close(), delete n.streams[e], n.OnEvent(new o.AudioStreamNodeDetachedEvent(n.id, e))) }, this.TurnOff = function () { for (var e in n.streams) if (e) { var t = n.streams[e]; t && t.Close() } return n.OnEvent(new o.AudioSourceOffEvent(n.id)), n.initializeDeferral = null, n.DestroyAudioContext(), o.PromiseHelper.FromResult(!0) }, this.Listen = function (e) { return n.TurnOn().OnSuccessContinueWith(function (t) { var r = new o.Stream(e); n.streams[e] = r; try { n.recorder.Record(n.context, n.mediaStream, r) } catch (t) { throw n.OnEvent(new o.AudioStreamNodeErrorEvent(n.id, e, t)), t } return r.GetReader() }) }, this.OnEvent = function (e) { n.events.OnEvent(e), o.Events.Instance.OnEvent(e) }, this.CreateAudioContext = function () { if (!n.context) { var e = window.AudioContext || window.webkitAudioContext || !1; if (!e) throw new Error("Browser does not support Web Audio API (AudioContext is not available)."); n.context = new e } }, this.DestroyAudioContext = function () { n.context && (n.recorder.ReleaseMediaResources(n.context), "close" in n.context ? (n.context.close(), n.context = null) : "running" === n.context.state && n.context.suspend()) }, this.id = t || o.CreateNoDashGuid(), this.events = new o.EventSource, this.recorder = e } return Object.defineProperty(e.prototype, "Format", { get: function () { return e.AUDIOFORMAT }, enumerable: !0, configurable: !0 }), Object.defineProperty(e.prototype, "Events", { get: function () { return this.events }, enumerable: !0, configurable: !0 }), e.AUDIOFORMAT = r.AudioStreamFormat.getDefaultInputFormat(), e }(); t.MicAudioSource = i }, function (e, t, n) { "use strict"; var r, o = this && this.__extends || (r = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (e, t) { e.__proto__ = t } || function (e, t) { for (var n in t) t.hasOwnProperty(n) && (e[n] = t[n]) }, function (e, t) { function n() { this.constructor = e } r(e, t), e.prototype = null === t ? Object.create(t) : (n.prototype = t.prototype, new n) }); Object.defineProperty(t, "__esModule", { value: !0 }); var i = n(6), s = n(0), c = n(17), a = function () { function e() { } return e.fromDefaultMicrophoneInput = function () { var e = new i.PcmRecorder; return new u(new i.MicAudioSource(e)) }, e.fromWavFileInput = function (e) { return new u(new i.FileAudioSource(e)) }, e.fromStreamInput = function (e) { if (e instanceof s.PullAudioInputStreamCallback) return new u(new c.PullAudioInputStreamImpl(e)); if (e instanceof s.AudioInputStream) return new u(e); throw new Error("Not Supported Type") }, e }(); t.AudioConfig = a; var u = function (e) { function t(t) { var n = e.call(this) || this; return n.source = t, n } return o(t, e), Object.defineProperty(t.prototype, "Format", { get: function () { return this.source.Format }, enumerable: !0, configurable: !0 }), t.prototype.close = function () { this.source.TurnOff() }, t.prototype.Id = function () { return this.source.Id() }, t.prototype.TurnOn = function () { return this.source.TurnOn() }, t.prototype.Attach = function (e) { return this.source.Attach(e) }, t.prototype.Detach = function (e) { return this.Detach(e) }, t.prototype.TurnOff = function () { return this.source.TurnOff() }, Object.defineProperty(t.prototype, "Events", { get: function () { return this.source.Events }, enumerable: !0, configurable: !0 }), t }(a); t.AudioConfigImpl = u }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }), function (e) { e[e.Error = 0] = "Error", e[e.EndOfStream = 1] = "EndOfStream" }(t.CancellationReason || (t.CancellationReason = {})) }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var r = function () { return function () { } }(); t.PullAudioInputStreamCallback = r }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var r = n(4), o = function () { function e() { this.disposed = !1 } return e.fromFile = function (e) { throw r.Contracts.throwIfFileDoesNotExist(e, "fileName"), new Error("Not yet implemented.") }, e.fromStream = function (e) { throw r.Contracts.throwIfNull(e, "file"), new Error("Not yet implemented.") }, e.prototype.close = function () { this.disposed || (this.disposed = !0) }, e }(); t.KeywordRecognitionModel = o }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var r = function () { function e(e) { this.privSessionId = e } return Object.defineProperty(e.prototype, "sessionId", { get: function () { return this.privSessionId }, enumerable: !0, configurable: !0 }), e }(); t.SessionEventArgs = r }, function (e, t, n) { "use strict"; var r, o = this && this.__extends || (r = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (e, t) { e.__proto__ = t } || function (e, t) { for (var n in t) t.hasOwnProperty(n) && (e[n] = t[n]) }, function (e, t) { function n() { this.constructor = e } r(e, t), e.prototype = null === t ? Object.create(t) : (n.prototype = t.prototype, new n) }); Object.defineProperty(t, "__esModule", { value: !0 }); var i = function (e) { function t(t, n) { var r = e.call(this, n) || this; return r.privOffset = t, r } return o(t, e), Object.defineProperty(t.prototype, "offset", { get: function () { return this.privOffset }, enumerable: !0, configurable: !0 }), t }(n(0).SessionEventArgs); t.RecognitionEventArgs = i }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }), function (e) { e[e.Simple = 0] = "Simple", e[e.Detailed = 1] = "Detailed" }(t.OutputFormat || (t.OutputFormat = {})) }, function (e, t, n) { "use strict"; var r, o = this && this.__extends || (r = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (e, t) { e.__proto__ = t } || function (e, t) { for (var n in t) t.hasOwnProperty(n) && (e[n] = t[n]) }, function (e, t) { function n() { this.constructor = e } r(e, t), e.prototype = null === t ? Object.create(t) : (n.prototype = t.prototype, new n) }); Object.defineProperty(t, "__esModule", { value: !0 }); var i = function (e) { function t(t, n, r) { var o = e.call(this, n, r) || this; return o.privResult = t, o } return o(t, e), Object.defineProperty(t.prototype, "result", { get: function () { return this.privResult }, enumerable: !0, configurable: !0 }), t }(n(0).RecognitionEventArgs); t.IntentRecognitionEventArgs = i }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var r = function () { function e(e, t, n, r, o, i, s, c) { this.privResultId = e, this.privReason = t, this.privText = n, this.privDuration = r, this.privOffset = o, this.privErrorDetails = i, this.privJson = s, this.privProperties = c } return Object.defineProperty(e.prototype, "resultId", { get: function () { return this.privResultId }, enumerable: !0, configurable: !0 }), Object.defineProperty(e.prototype, "reason", { get: function () { return this.privReason }, enumerable: !0, configurable: !0 }), Object.defineProperty(e.prototype, "text", { get: function () { return this.privText }, enumerable: !0, configurable: !0 }), Object.defineProperty(e.prototype, "duration", { get: function () { return this.privDuration }, enumerable: !0, configurable: !0 }), Object.defineProperty(e.prototype, "offset", { get: function () { return this.privOffset }, enumerable: !0, configurable: !0 }), Object.defineProperty(e.prototype, "errorDetails", { get: function () { return this.privErrorDetails }, enumerable: !0, configurable: !0 }), Object.defineProperty(e.prototype, "json", { get: function () { return this.privJson }, enumerable: !0, configurable: !0 }), Object.defineProperty(e.prototype, "properties", { get: function () { return this.privProperties }, enumerable: !0, configurable: !0 }), e }(); t.RecognitionResult = r }, function (e, t, n) { "use strict"; var r, o = this && this.__extends || (r = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (e, t) { e.__proto__ = t } || function (e, t) { for (var n in t) t.hasOwnProperty(n) && (e[n] = t[n]) }, function (e, t) { function n() { this.constructor = e } r(e, t), e.prototype = null === t ? Object.create(t) : (n.prototype = t.prototype, new n) }); Object.defineProperty(t, "__esModule", { value: !0 }); var i = function (e) { function t(t, n, r, o, i, s, c, a) { return e.call(this, t, n, r, o, i, s, c, a) || this } return o(t, e), t }(n(0).RecognitionResult); t.SpeechRecognitionResult = i }, function (e, t, n) { "use strict"; var r, o = this && this.__extends || (r = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (e, t) { e.__proto__ = t } || function (e, t) { for (var n in t) t.hasOwnProperty(n) && (e[n] = t[n]) }, function (e, t) { function n() { this.constructor = e } r(e, t), e.prototype = null === t ? Object.create(t) : (n.prototype = t.prototype, new n) }); Object.defineProperty(t, "__esModule", { value: !0 }); var i = function (e) { function t(t, n, r, o, i, s, c, a, u) { var p = e.call(this, n, r, o, i, s, c, a, u) || this; return p.privIntentId = t, p } return o(t, e), Object.defineProperty(t.prototype, "intentId", { get: function () { return this.privIntentId }, enumerable: !0, configurable: !0 }), t }(n(0).SpeechRecognitionResult); t.IntentRecognitionResult = i }, function (e, t, n) { "use strict"; var r, o = this && this.__extends || (r = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (e, t) { e.__proto__ = t } || function (e, t) { for (var n in t) t.hasOwnProperty(n) && (e[n] = t[n]) }, function (e, t) { function n() { this.constructor = e } r(e, t), e.prototype = null === t ? Object.create(t) : (n.prototype = t.prototype, new n) }); Object.defineProperty(t, "__esModule", { value: !0 }); var i = n(4), s = function () { function e() { } return e.fromEndpoint = function (e) { i.Contracts.throwIfNull(e, "uri"), i.Contracts.throwIfNullOrWhitespace(e.hostname, "uri"); var t = new c, n = e.host.indexOf("."); if (-1 === n) throw new Error("Could not determine region from endpoint"); t.region = e.host.substr(0, n); var r = e.pathname.lastIndexOf("/") + 1; if (-1 === r) throw new Error("Could not determine appId from endpoint"); if (t.appId = e.pathname.substr(r), t.subscriptionKey = e.searchParams.get("subscription-key"), void 0 === t.subscriptionKey) throw new Error("Could not determine subscription key from endpoint"); return t }, e.fromAppId = function (e) { i.Contracts.throwIfNullOrWhitespace(e, "appId"); var t = new c; return t.appId = e, t }, e.fromSubscription = function (e, t, n) { i.Contracts.throwIfNullOrWhitespace(e, "subscriptionKey"), i.Contracts.throwIfNullOrWhitespace(t, "appId"), i.Contracts.throwIfNullOrWhitespace(n, "region"); var r = new c; return r.appId = t, r.region = n, r.subscriptionKey = e, r }, e }(); t.LanguageUnderstandingModel = s; var c = function (e) { function t() { return null !== e && e.apply(this, arguments) || this } return o(t, e), t }(s); t.LanguageUnderstandingModelImpl = c }, function (e, t, n) { "use strict"; var r, o = this && this.__extends || (r = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (e, t) { e.__proto__ = t } || function (e, t) { for (var n in t) t.hasOwnProperty(n) && (e[n] = t[n]) }, function (e, t) { function n() { this.constructor = e } r(e, t), e.prototype = null === t ? Object.create(t) : (n.prototype = t.prototype, new n) }); Object.defineProperty(t, "__esModule", { value: !0 }); var i = function (e) { function t(t, n, r) { var o = e.call(this, n, r) || this; return o.privResult = t, o } return o(t, e), Object.defineProperty(t.prototype, "result", { get: function () { return this.privResult }, enumerable: !0, configurable: !0 }), t }(n(0).RecognitionEventArgs); t.SpeechRecognitionEventArgs = i }, function (e, t, n) { "use strict"; var r, o = this && this.__extends || (r = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (e, t) { e.__proto__ = t } || function (e, t) { for (var n in t) t.hasOwnProperty(n) && (e[n] = t[n]) }, function (e, t) { function n() { this.constructor = e } r(e, t), e.prototype = null === t ? Object.create(t) : (n.prototype = t.prototype, new n) }); Object.defineProperty(t, "__esModule", { value: !0 }); var i = function (e) { function t(t, n, r, o, i) { var s = e.call(this, o, i) || this; return s.privReason = t, s.privErrorDetails = n, s.privErrorCode = r, s } return o(t, e), Object.defineProperty(t.prototype, "reason", { get: function () { return this.privReason }, enumerable: !0, configurable: !0 }), Object.defineProperty(t.prototype, "errorCode", { get: function () { return this.privErrorCode }, enumerable: !0, configurable: !0 }), Object.defineProperty(t.prototype, "errorDetails", { get: function () { return this.privErrorDetails }, enumerable: !0, configurable: !0 }), t }(n(0).RecognitionEventArgs); t.SpeechRecognitionCanceledEventArgs = i }, function (e, t, n) { "use strict"; var r, o = this && this.__extends || (r = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (e, t) { e.__proto__ = t } || function (e, t) { for (var n in t) t.hasOwnProperty(n) && (e[n] = t[n]) }, function (e, t) { function n() { this.constructor = e } r(e, t), e.prototype = null === t ? Object.create(t) : (n.prototype = t.prototype, new n) }); Object.defineProperty(t, "__esModule", { value: !0 }); var i = function (e) { function t(t, n, r) { var o = e.call(this, n, r) || this; return o.privResult = t, o } return o(t, e), Object.defineProperty(t.prototype, "result", { get: function () { return this.privResult }, enumerable: !0, configurable: !0 }), t }(n(0).RecognitionEventArgs); t.TranslationRecognitionEventArgs = i }, function (e, t, n) { "use strict"; var r, o = this && this.__extends || (r = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (e, t) { e.__proto__ = t } || function (e, t) { for (var n in t) t.hasOwnProperty(n) && (e[n] = t[n]) }, function (e, t) { function n() { this.constructor = e } r(e, t), e.prototype = null === t ? Object.create(t) : (n.prototype = t.prototype, new n) }); Object.defineProperty(t, "__esModule", { value: !0 }); var i = function (e) { function t(t, n) { var r = e.call(this, n) || this; return r.privResult = t, r } return o(t, e), Object.defineProperty(t.prototype, "result", { get: function () { return this.privResult }, enumerable: !0, configurable: !0 }), t }(n(0).SessionEventArgs); t.TranslationSynthesisEventArgs = i }, function (e, t, n) { "use strict"; var r, o = this && this.__extends || (r = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (e, t) { e.__proto__ = t } || function (e, t) { for (var n in t) t.hasOwnProperty(n) && (e[n] = t[n]) }, function (e, t) { function n() { this.constructor = e } r(e, t), e.prototype = null === t ? Object.create(t) : (n.prototype = t.prototype, new n) }); Object.defineProperty(t, "__esModule", { value: !0 }); var i = function (e) { function t(t, n, r, o, i, s, c, a, u) { var p = e.call(this, n, r, o, i, s, c, a, u) || this; return p.privTranslations = t, p } return o(t, e), Object.defineProperty(t.prototype, "translations", { get: function () { return this.privTranslations }, enumerable: !0, configurable: !0 }), t }(n(0).SpeechRecognitionResult); t.TranslationRecognitionResult = i }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var r = function () { function e(e, t) { this.privReason = e, this.privAudio = t } return Object.defineProperty(e.prototype, "audio", { get: function () { return this.privAudio }, enumerable: !0, configurable: !0 }), Object.defineProperty(e.prototype, "reason", { get: function () { return this.privReason }, enumerable: !0, configurable: !0 }), e }(); t.TranslationSynthesisResult = r }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }), function (e) { e[e.NoMatch = 0] = "NoMatch", e[e.Canceled = 1] = "Canceled", e[e.RecognizingSpeech = 2] = "RecognizingSpeech", e[e.RecognizedSpeech = 3] = "RecognizedSpeech", e[e.RecognizingIntent = 4] = "RecognizingIntent", e[e.RecognizedIntent = 5] = "RecognizedIntent", e[e.TranslatingSpeech = 6] = "TranslatingSpeech", e[e.TranslatedSpeech = 7] = "TranslatedSpeech", e[e.SynthesizingAudio = 8] = "SynthesizingAudio", e[e.SynthesizingAudioCompleted = 9] = "SynthesizingAudioCompleted" }(t.ResultReason || (t.ResultReason = {})) }, function (e, t, n) { "use strict"; var r, o = this && this.__extends || (r = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (e, t) { e.__proto__ = t } || function (e, t) { for (var n in t) t.hasOwnProperty(n) && (e[n] = t[n]) }, function (e, t) { function n() { this.constructor = e } r(e, t), e.prototype = null === t ? Object.create(t) : (n.prototype = t.prototype, new n) }); Object.defineProperty(t, "__esModule", { value: !0 }); var i = n(2), s = n(4), c = n(0), a = function () { function e() { } return e.fromSubscription = function (e, t) { s.Contracts.throwIfNullOrWhitespace(e, "subscriptionKey"), s.Contracts.throwIfNullOrWhitespace(t, "region"); var n = new u; return n.setProperty(c.PropertyId.SpeechServiceConnection_Region, t), n.setProperty(c.PropertyId.SpeechServiceConnection_IntentRegion, t), n.setProperty(c.PropertyId.SpeechServiceConnection_Key, e), n }, e.fromEndpoint = function (e, t) { s.Contracts.throwIfNull(e, "endpoint"), s.Contracts.throwIfNullOrWhitespace(t, "subscriptionKey"); var n = new u; return n.setProperty(c.PropertyId.SpeechServiceConnection_Endpoint, e.href), n.setProperty(c.PropertyId.SpeechServiceConnection_Key, t), n }, e.fromAuthorizationToken = function (e, t) { s.Contracts.throwIfNull(e, "authorizationToken"), s.Contracts.throwIfNullOrWhitespace(t, "region"); var n = new u; return n.setProperty(c.PropertyId.SpeechServiceConnection_Region, t), n.setProperty(c.PropertyId.SpeechServiceConnection_IntentRegion, t), n.authorizationToken = e, n }, e.prototype.close = function () { }, e }(); t.SpeechConfig = a; var u = function (e) { function t() { var t = e.call(this) || this; return t.privProperties = new c.PropertyCollection, t.speechRecognitionLanguage = "en-US", t.outputFormat = c.OutputFormat.Simple, t } return o(t, e), Object.defineProperty(t.prototype, "properties", { get: function () { return this.privProperties }, enumerable: !0, configurable: !0 }), Object.defineProperty(t.prototype, "endPoint", { get: function () { return new URL(this.privProperties.getProperty(c.PropertyId.SpeechServiceConnection_Endpoint)) }, enumerable: !0, configurable: !0 }), Object.defineProperty(t.prototype, "subscriptionKey", { get: function () { return this.privProperties.getProperty(c.PropertyId.SpeechServiceConnection_Key) }, enumerable: !0, configurable: !0 }), Object.defineProperty(t.prototype, "region", { get: function () { return this.privProperties.getProperty(c.PropertyId.SpeechServiceConnection_Region) }, enumerable: !0, configurable: !0 }), Object.defineProperty(t.prototype, "authorizationToken", { get: function () { return this.privProperties.getProperty(c.PropertyId.SpeechServiceAuthorization_Token) }, set: function (e) { this.privProperties.setProperty(c.PropertyId.SpeechServiceAuthorization_Token, e) }, enumerable: !0, configurable: !0 }), Object.defineProperty(t.prototype, "speechRecognitionLanguage", { get: function () { return this.privProperties.getProperty(c.PropertyId.SpeechServiceConnection_RecoLanguage) }, set: function (e) { this.privProperties.setProperty(c.PropertyId.SpeechServiceConnection_RecoLanguage, e) }, enumerable: !0, configurable: !0 }), Object.defineProperty(t.prototype, "outputFormat", { get: function () { return c.OutputFormat[this.privProperties.getProperty(i.OutputFormatPropertyName, c.OutputFormat[c.OutputFormat.Simple])] }, set: function (e) { this.privProperties.setProperty(i.OutputFormatPropertyName, c.OutputFormat[e]) }, enumerable: !0, configurable: !0 }), Object.defineProperty(t.prototype, "endpointId", { get: function () { return this.privProperties.getProperty(c.PropertyId.SpeechServiceConnection_EndpointId) }, set: function (e) { this.privProperties.setProperty(c.PropertyId.SpeechServiceConnection_EndpointId, e) }, enumerable: !0, configurable: !0 }), t.prototype.setProperty = function (e, t) { s.Contracts.throwIfNullOrWhitespace(t, "value"), this.privProperties.setProperty(e, t) }, t.prototype.getProperty = function (e, t) { return this.privProperties.getProperty(e, t) }, t.prototype.clone = function () { var e = new t; return e.privProperties = this.privProperties.clone(), e }, t }(a); t.SpeechConfigImpl = u }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var r = n(1), o = n(9), i = "Ocp-Apim-Subscription-Key", s = function () { return function (e) { var t = this; if (this.Fetch = function (e) { return r.PromiseHelper.FromResult(t.authInfo) }, this.FetchOnExpiry = function (e) { return r.PromiseHelper.FromResult(t.authInfo) }, !e) throw new r.ArgumentNullError("subscriptionKey"); this.authInfo = new o.AuthInfo(i, e) } }(); t.CognitiveSubscriptionKeyAuthentication = s }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var r = n(1), o = n(9), i = "Authorization", s = function () { return function (e, t) { var n = this; if (this.Fetch = function (e) { return n.fetchCallback(e).OnSuccessContinueWith(function (e) { return new o.AuthInfo(i, e) }) }, this.FetchOnExpiry = function (e) { return n.fetchOnExpiryCallback(e).OnSuccessContinueWith(function (e) { return new o.AuthInfo(i, e) }) }, !e) throw new r.ArgumentNullError("fetchCallback"); if (!t) throw new r.ArgumentNullError("fetchOnExpiryCallback"); this.fetchCallback = e, this.fetchOnExpiryCallback = t } }(); t.CognitiveTokenAuthentication = s }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var r = n(6), o = n(1), i = n(0), s = n(2), c = "testhooks", a = "X-ConnectionId", u = function () { function e() { var e = this; this.Create = function (t, n, u) { var p = t.parameters.getProperty(i.PropertyId.SpeechServiceConnection_Endpoint); if (!p) { var l = t.parameters.getProperty(i.PropertyId.SpeechServiceConnection_IntentRegion); p = e.Host() + o.Storage.Local.GetOrAdd("TranslationRelativeUri", "/speech/" + e.GetSpeechRegionFromIntentRegion(l) + "/recognition/interactive/cognitiveservices/v1") } var f = { format: "simple", language: t.parameters.getProperty(i.PropertyId.SpeechServiceConnection_RecoLanguage) }; e.IsDebugModeEnabled && (f[c] = "1"); var d = {}; return d[n.HeaderName] = n.Token, d[a] = u, new r.WebsocketConnection(p, f, d, new s.WebsocketMessageFormatter, u) } } return e.prototype.Host = function () { return o.Storage.Local.GetOrAdd("Host", "wss://speech.platform.bing.com") }, Object.defineProperty(e.prototype, "IsDebugModeEnabled", { get: function () { return "true" === o.Storage.Local.GetOrAdd("IsDebugModeEnabled", "false").toLowerCase() }, enumerable: !0, configurable: !0 }), e.prototype.GetSpeechRegionFromIntentRegion = function (e) { switch (e) { case "West US": case "US West": case "westus": return "uswest"; case "West US 2": case "US West 2": case "westus2": return "uswest2"; case "South Central US": case "US South Central": case "southcentralus": return "ussouthcentral"; case "West Central US": case "US West Central": case "westcentralus": return "uswestcentral"; case "East US": case "US East": case "eastus": return "useast"; case "East US 2": case "US East 2": case "eastus2": return "useast2"; case "West Europe": case "Europe West": case "westeurope": return "europewest"; case "North Europe": case "Europe North": case "northeurope": return "europenorth"; case "Brazil South": case "South Brazil": case "southbrazil": return "brazilsouth"; case "Australia East": case "East Australia": case "eastaustralia": return "australiaeast"; case "Southeast Asia": case "Asia Southeast": case "southeastasia": return "asiasoutheast"; case "East Asia": case "Asia East": case "eastasia": return "asiaeast"; default: return e } }, e }(); t.IntentConnectionFactory = u }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var r = n(1), o = n(0), i = n(2), s = n(59), c = function () { function e(t, n, c, a, u) { var p = this; if (this.SendTelemetryData = function (t, n, o) { if (e.TelemetryData) try { e.TelemetryData(o) } catch (e) { } return n.Send(new s.SpeechConnectionMessage(r.MessageType.Text, "telemetry", t, "application/json", o)) }, this.FetchConnection = function (e, t) { if (void 0 === t && (t = !1), p.connectionFetchPromise) return p.connectionFetchPromise.Result().IsError || p.connectionFetchPromise.Result().Result.State() === r.ConnectionState.Disconnected ? (p.connectionId = null, p.connectionFetchPromise = null, p.FetchConnection(e)) : (e.OnPreConnectionStart(p.authFetchEventId, p.connectionId), e.OnConnectionEstablishCompleted(200), e.ListenForServiceTelemetry(p.connectionFetchPromise.Result().Result.Events), p.connectionFetchPromise); p.authFetchEventId = r.CreateNoDashGuid(), p.connectionId = r.CreateNoDashGuid(), e.OnPreConnectionStart(p.authFetchEventId, p.connectionId); var n = t ? p.authentication.FetchOnExpiry(p.authFetchEventId) : p.authentication.Fetch(p.authFetchEventId); return p.connectionFetchPromise = n.ContinueWithPromise(function (n) { if (n.IsError) throw e.OnAuthCompleted(!0, n.Error), new Error(n.Error); return e.OnAuthCompleted(!1), p.connection && (p.connection.Dispose(), p.connection = void 0), p.connection = p.connectionFactory.Create(p.recognizerConfig, n.Result, p.connectionId), e.ListenForServiceTelemetry(p.connection.Events), p.connection.Open().OnSuccessContinueWithPromise(function (n) { return 200 === n.StatusCode ? (e.OnConnectionEstablishCompleted(n.StatusCode), r.PromiseHelper.FromResult(p.connection)) : 403 !== n.StatusCode || t ? (e.OnConnectionEstablishCompleted(n.StatusCode, n.Reason), r.PromiseHelper.FromError("Unable to contact server. StatusCode: " + n.StatusCode + ", Reason: " + n.Reason)) : p.FetchConnection(e, !0) }) }), p.connectionFetchPromise }, this.ReceiveMessage = function (e, t, n, c) { return e.Read().OnSuccessContinueWithPromise(function (a) { if (!a) return r.PromiseHelper.FromResult(!0); var u = s.SpeechConnectionMessage.FromConnectionMessage(a); if (u.RequestId.toLowerCase() === t.RequestId.toLowerCase()) switch (u.Path.toLowerCase()) { case "turn.start": var l = new o.SessionEventArgs(t.SessionId); p.recognizer.sessionStarted && p.recognizer.sessionStarted(p.recognizer, l); break; case "speech.startdetected": var f = i.SpeechDetected.FromJSON(u.TextBody), d = new o.RecognitionEventArgs(f.Offset, t.SessionId); p.recognizer.speechStartDetected && p.recognizer.speechStartDetected(p.recognizer, d); break; case "speech.enddetected": var h = void 0; h = u.TextBody.length > 0 ? u.TextBody : "{ Offset: 0 }"; var g = i.SpeechDetected.FromJSON(h), v = new o.RecognitionEventArgs(g.Offset, t.SessionId); p.recognizer.speechEndDetected && p.recognizer.speechEndDetected(p.recognizer, v); break; case "turn.end": var y = new o.SessionEventArgs(t.SessionId); return p.recognizer.sessionStopped && p.recognizer.sessionStopped(p.recognizer, y), t.OnServiceTurnEndResponse(), r.PromiseHelper.FromResult(!0); default: p.ProcessTypeSpecificMessages(u, t, e, n, c) }return p.ReceiveMessage(e, t, n, c) }) }, this.SendSpeechConfig = function (e, t, n) { return n && p.connectionId !== p.speechConfigConnectionId ? (p.speechConfigConnectionId = p.connectionId, t.Send(new s.SpeechConnectionMessage(r.MessageType.Text, "speech.config", e, "application/json", n))) : r.PromiseHelper.FromResult(!0) }, this.SendSpeechContext = function (e, t, n) { return n ? t.Send(new s.SpeechConnectionMessage(r.MessageType.Text, "speech.context", e, "application/json", n)) : r.PromiseHelper.FromResult(!0) }, this.SendAudio = function (e, t, n, o) { var i = new r.Deferred, c = 0, a = p.audioSource.Format, u = function (l) { p.isDisposed || o.IsSpeechEnded || o.IsCompleted || n.Read().On(function (n) { if (o.IsSpeechEnded) i.Resolve(!0); else { var p = n.IsEnd ? null : n.Buffer, l = t.Send(new s.SpeechConnectionMessage(r.MessageType.Binary, "audio", e, null, p)); if (n.IsEnd) i.Resolve(!0); else { var f = p.byteLength / a.avgBytesPerSec / 2 * 1e3, d = Math.max(0, c - Date.now() + f); l.OnSuccessContinueWith(function (e) { setTimeout(function () { c = Date.now(), u(e) }, d) }) } } }, function (e) { o.IsSpeechEnded ? i.Resolve(!0) : i.Reject(e) }) }; return u(!0), i.Promise() }, !t) throw new r.ArgumentNullError("authentication"); if (!n) throw new r.ArgumentNullError("connectionFactory"); if (!c) throw new r.ArgumentNullError("audioSource"); if (!a) throw new r.ArgumentNullError("recognizerConfig"); this.authentication = t, this.connectionFactory = n, this.audioSource = c, this.recognizerConfig = a, this.isDisposed = !1, this.recognizer = u } return Object.defineProperty(e.prototype, "AudioSource", { get: function () { return this.audioSource }, enumerable: !0, configurable: !0 }), e.prototype.IsDisposed = function () { return this.isDisposed }, e.prototype.Dispose = function (e) { this.isDisposed = !0, this.connection && (this.connection.Dispose(e), this.connection = void 0) }, e.prototype.Recognize = function (e, t, n) { var o = this, s = new i.RequestSession(this.audioSource.Id()); return s.ListenForServiceTelemetry(this.audioSource.Events), this.audioSource.Attach(s.AudioNodeId).ContinueWithPromise(function (i) { if (i.IsError) throw o.ErrorCallback(i.Error), new Error(i.Error); s.OnAudioSourceAttachCompleted(i.Result, !1); var c = i.Result; return o.FetchConnection(s).On(function (i) { var a = o.ReceiveMessage(i, s, t, n), u = o.SendSpeechConfig(s.RequestId, i, o.recognizerConfig.PlatformConfig.Serialize()).OnSuccessContinueWithPromise(function (t) { return o.SendSpeechContext(s.RequestId, i, e).OnSuccessContinueWithPromise(function (e) { return o.SendAudio(s.RequestId, i, c, s) }) }), p = r.PromiseHelper.WhenAll([a, u]); return p.On(function (e) { s.Dispose(), o.SendTelemetryData(s.RequestId, i, s.GetTelemetry()) }, function (e) { s.Dispose(e), o.SendTelemetryData(s.RequestId, i, s.GetTelemetry()) }), p }, function (e) { o.ConnectionError(s.SessionId, s.RequestId, e) }).OnSuccessContinueWithPromise(function () { return s.CompletionPromise }) }) }, e.prototype.ErrorCallback = function (e) { throw new Error(e) }, e }(); t.ServiceRecognizerBase = c }, function (e, t, n) { "use strict"; var r, o = this && this.__extends || (r = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (e, t) { e.__proto__ = t } || function (e, t) { for (var n in t) t.hasOwnProperty(n) && (e[n] = t[n]) }, function (e, t) { function n() { this.constructor = e } r(e, t), e.prototype = null === t ? Object.create(t) : (n.prototype = t.prototype, new n) }); Object.defineProperty(t, "__esModule", { value: !0 }); var i = n(1), s = "path", c = "content-type", a = "x-requestid", u = "x-timestamp", p = function (e) { function t(t, n, r, o, p, l, f) { var d = this; if (!n) throw new i.ArgumentNullError("path"); if (!r) throw new i.ArgumentNullError("requestId"); var h = {}; if (h[s] = n, h[a] = r, h[u] = (new Date).toISOString(), o && (h[c] = o), l) for (var g in l) g && (h[g] = l[g]); return (d = f ? e.call(this, t, p, h, f) || this : e.call(this, t, p, h) || this).path = n, d.requestId = r, d.contentType = o, d.additionalHeaders = l, d } return o(t, e), Object.defineProperty(t.prototype, "Path", { get: function () { return this.path }, enumerable: !0, configurable: !0 }), Object.defineProperty(t.prototype, "RequestId", { get: function () { return this.requestId }, enumerable: !0, configurable: !0 }), Object.defineProperty(t.prototype, "ContentType", { get: function () { return this.contentType }, enumerable: !0, configurable: !0 }), Object.defineProperty(t.prototype, "AdditionalHeaders", { get: function () { return this.additionalHeaders }, enumerable: !0, configurable: !0 }), t.FromConnectionMessage = function (e) { var n = null, r = null, o = null, i = {}; if (e.Headers) for (var p in e.Headers) p && (p.toLowerCase() === s.toLowerCase() ? n = e.Headers[p] : p.toLowerCase() === a.toLowerCase() ? r = e.Headers[p] : p.toLowerCase() === u.toLowerCase() ? e.Headers[p] : p.toLowerCase() === c.toLowerCase() ? o = e.Headers[p] : i[p] = e.Headers[p]); return new t(e.MessageType, n, r, o, e.Body, i, e.Id) }, t }(i.ConnectionMessage); t.SpeechConnectionMessage = p }, function (e, t, n) { "use strict"; var r; Object.defineProperty(t, "__esModule", { value: !0 }), function (e) { e[e.Interactive = 0] = "Interactive", e[e.Conversation = 1] = "Conversation", e[e.Dictation = 2] = "Dictation" }(r = t.RecognitionMode || (t.RecognitionMode = {})), function (e) { e[e.Simple = 0] = "Simple", e[e.Detailed = 1] = "Detailed" }(t.SpeechResultFormat || (t.SpeechResultFormat = {})); var o = function () { function e(e, t, n) { void 0 === t && (t = r.Interactive), this.recognitionMode = r.Interactive, this.platformConfig = e || new i(new s(null)), this.recognitionMode = t, this.recognitionActivityTimeout = t === r.Interactive ? 8e3 : 25e3, this.speechConfig = n } return Object.defineProperty(e.prototype, "parameters", { get: function () { return this.speechConfig }, enumerable: !0, configurable: !0 }), Object.defineProperty(e.prototype, "RecognitionMode", { get: function () { return this.recognitionMode }, enumerable: !0, configurable: !0 }), Object.defineProperty(e.prototype, "PlatformConfig", { get: function () { return this.platformConfig }, enumerable: !0, configurable: !0 }), Object.defineProperty(e.prototype, "RecognitionActivityTimeout", { get: function () { return this.recognitionActivityTimeout }, enumerable: !0, configurable: !0 }), Object.defineProperty(e.prototype, "IsContinuousRecognition", { get: function () { return this.recognitionMode !== r.Interactive }, enumerable: !0, configurable: !0 }), e }(); t.RecognizerConfig = o; var i = function () { function e(e) { var t = this; this.Serialize = function () { return JSON.stringify(t, function (e, t) { if (t && "object" == typeof t) { var n = {}; for (var r in t) Object.hasOwnProperty.call(t, r) && (n[r && r.charAt(0).toLowerCase() + r.substring(1)] = t[r]); return n } return t }) }, this.context = e } return Object.defineProperty(e.prototype, "Context", { get: function () { return this.context }, enumerable: !0, configurable: !0 }), e }(); t.PlatformConfig = i; var s = function () { function e(e) { this.system = new c, this.os = e } return Object.defineProperty(e.prototype, "System", { get: function () { return this.system }, enumerable: !0, configurable: !0 }), Object.defineProperty(e.prototype, "OS", { get: function () { return this.os }, enumerable: !0, configurable: !0 }), e }(); t.Context = s; var c = function () { function e() { this.name = "SpeechSDK", this.version = "1.1.0", this.build = "JavaScript", this.lang = "JavaScript" } return Object.defineProperty(e.prototype, "Version", { get: function () { return this.version }, enumerable: !0, configurable: !0 }), Object.defineProperty(e.prototype, "Lang", { get: function () { return this.lang }, enumerable: !0, configurable: !0 }), e }(); t.System = c; var a = function () { function e(e, t, n) { this.platform = e, this.name = t, this.version = n } return Object.defineProperty(e.prototype, "Platform", { get: function () { return this.platform }, enumerable: !0, configurable: !0 }), Object.defineProperty(e.prototype, "Name", { get: function () { return this.name }, enumerable: !0, configurable: !0 }), Object.defineProperty(e.prototype, "Version", { get: function () { return this.version }, enumerable: !0, configurable: !0 }), e }(); t.OS = a; var u = function () { function e(e, t, n) { this.manufacturer = e, this.model = t, this.version = n } return Object.defineProperty(e.prototype, "Manufacturer", { get: function () { return this.manufacturer }, enumerable: !0, configurable: !0 }), Object.defineProperty(e.prototype, "Model", { get: function () { return this.model }, enumerable: !0, configurable: !0 }), Object.defineProperty(e.prototype, "Version", { get: function () { return this.version }, enumerable: !0, configurable: !0 }), e }(); t.Device = u }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var r = n(1), o = "\r\n", i = function () { return function () { var e = this; this.ToConnectionMessage = function (t) { var n = new r.Deferred; try { if (t.MessageType === r.MessageType.Text) { var o = t.TextContent, i = {}, s = null; if (o) { var c = o.split("\r\n\r\n"); c && c.length > 0 && (i = e.ParseHeaders(c[0]), c.length > 1 && (s = c[1])) } n.Resolve(new r.ConnectionMessage(t.MessageType, s, i, t.Id)) } else if (t.MessageType === r.MessageType.Binary) { var a = t.BinaryContent; if (i = {}, s = null, !a || a.byteLength < 2) throw new Error("Invalid binary message format. Header length missing."); var u = new DataView(a), p = u.getInt16(0); if (a.byteLength < p + 2) throw new Error("Invalid binary message format. Header content missing."); for (var l = "", f = 0; f < p; f++)l += String.fromCharCode(u.getInt8(f + 2)); i = e.ParseHeaders(l), a.byteLength > p + 2 && (s = a.slice(2 + p)), n.Resolve(new r.ConnectionMessage(t.MessageType, s, i, t.Id)) } } catch (e) { n.Reject("Error formatting the message. Error: " + e) } return n.Promise() }, this.FromConnectionMessage = function (t) { var n = new r.Deferred; try { if (t.MessageType === r.MessageType.Text) { var i = "" + e.MakeHeaders(t) + o + (t.TextBody ? t.TextBody : ""); n.Resolve(new r.RawWebsocketMessage(r.MessageType.Text, i, t.Id)) } else if (t.MessageType === r.MessageType.Binary) { var s = e.MakeHeaders(t), c = t.BinaryBody, a = new Int8Array(e.StringToArrayBuffer(s)), u = (i = new ArrayBuffer(2 + a.byteLength + (c ? c.byteLength : 0)), new DataView(i)); u.setInt16(0, a.length); for (var p = 0; p < a.byteLength; p++)u.setInt8(2 + p, a[p]); if (c) { var l = new Int8Array(c); for (p = 0; p < l.byteLength; p++)u.setInt8(2 + a.byteLength + p, l[p]) } n.Resolve(new r.RawWebsocketMessage(r.MessageType.Binary, i, t.Id)) } } catch (e) { n.Reject("Error formatting the message. " + e) } return n.Promise() }, this.MakeHeaders = function (e) { var t = ""; if (e.Headers) for (var n in e.Headers) n && (t += n + ": " + e.Headers[n] + o); return t }, this.ParseHeaders = function (e) { var t = {}; if (e) { var n = e.match(/[^\r\n]+/g); if (t) for (var r = 0, o = n; r < o.length; r++) { var i = o[r]; if (i) { var s = i.indexOf(":"), c = s > 0 ? i.substr(0, s).trim().toLowerCase() : i, a = s > 0 && i.length > s + 1 ? i.substr(s + 1).trim() : ""; t[c] = a } } } return t }, this.StringToArrayBuffer = function (e) { for (var t = new ArrayBuffer(e.length), n = new DataView(t), r = 0; r < e.length; r++)n.setUint8(r, e.charCodeAt(r)); return t } } }(); t.WebsocketMessageFormatter = i }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var r = function () { function e() { } return Object.defineProperty(e, "TestHooksParamName", { get: function () { return "testhooks" }, enumerable: !0, configurable: !0 }), Object.defineProperty(e, "ConnectionIdHeader", { get: function () { return "X-ConnectionId" }, enumerable: !0, configurable: !0 }), Object.defineProperty(e, "DeploymentIdParamName", { get: function () { return "cid" }, enumerable: !0, configurable: !0 }), Object.defineProperty(e, "FormatParamName", { get: function () { return "format" }, enumerable: !0, configurable: !0 }), Object.defineProperty(e, "LanguageParamName", { get: function () { return "language" }, enumerable: !0, configurable: !0 }), Object.defineProperty(e, "TranslationFromParamName", { get: function () { return "from" }, enumerable: !0, configurable: !0 }), Object.defineProperty(e, "TranslationToParamName", { get: function () { return "to" }, enumerable: !0, configurable: !0 }), e }(); t.QueryParameterNames = r }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var r = n(6), o = n(1), i = n(0), s = n(2), c = "testhooks", a = "X-ConnectionId", u = function () { function e() { var e = this; this.Create = function (t, n, u) { var p = t.parameters.getProperty(i.PropertyId.SpeechServiceConnection_Endpoint, void 0); if (!p) { var l = t.parameters.getProperty(i.PropertyId.SpeechServiceConnection_Region, void 0); p = e.Host(l) + o.Storage.Local.GetOrAdd("TranslationRelativeUri", "/speech/translation/cognitiveservices/v1") } var f = { from: t.parameters.getProperty(i.PropertyId.SpeechServiceConnection_RecoLanguage), to: t.parameters.getProperty(i.PropertyId.SpeechServiceConnection_TranslationToLanguages) }; e.IsDebugModeEnabled && (f[c] = "1"); void 0 !== t.parameters.getProperty(i.PropertyId.SpeechServiceConnection_TranslationVoice, void 0) && (f.voice = t.parameters.getProperty(i.PropertyId.SpeechServiceConnection_TranslationVoice), f.features = "texttospeech"); var d = {}; return d[n.HeaderName] = n.Token, d[a] = u, new r.WebsocketConnection(p, f, d, new s.WebsocketMessageFormatter, u) } } return e.prototype.Host = function (e) { return o.Storage.Local.GetOrAdd("Host", "wss://" + e + ".s2s.speech.microsoft.com") }, Object.defineProperty(e.prototype, "IsDebugModeEnabled", { get: function () { return "true" === o.Storage.Local.GetOrAdd("IsDebugModeEnabled", "false").toLowerCase() }, enumerable: !0, configurable: !0 }), e }(); t.TranslationConnectionFactory = u }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var r = n(0), o = n(2), i = function () { function e() { } return e.implTranslateRecognitionResult = function (e) { var t = r.ResultReason.Canceled; switch (e) { case o.RecognitionStatus.Success: t = r.ResultReason.RecognizedSpeech; break; case o.RecognitionStatus.NoMatch: case o.RecognitionStatus.InitialSilenceTimeout: case o.RecognitionStatus.BabbleTimeout: t = r.ResultReason.NoMatch; break; case o.RecognitionStatus.EndOfDictation: case o.RecognitionStatus.Error: default: t = r.ResultReason.Canceled }return t }, e.implTranslateCancelResult = function (e) { var t = r.CancellationReason.EndOfStream; switch (e) { case o.RecognitionStatus.Success: case o.RecognitionStatus.EndOfDictation: case o.RecognitionStatus.NoMatch: t = r.CancellationReason.EndOfStream; break; case o.RecognitionStatus.InitialSilenceTimeout: case o.RecognitionStatus.BabbleTimeout: case o.RecognitionStatus.Error: default: t = r.CancellationReason.Error }return t }, e }(); t.EnumTranslation = i }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }), function (e) { e[e.Success = 0] = "Success", e[e.SynthesisEnd = 1] = "SynthesisEnd", e[e.Error = 2] = "Error" }(t.SynthesisStatus || (t.SynthesisStatus = {})), function (e) { e[e.Success = 0] = "Success", e[e.NoMatch = 1] = "NoMatch", e[e.InitialSilenceTimeout = 2] = "InitialSilenceTimeout", e[e.BabbleTimeout = 3] = "BabbleTimeout", e[e.Error = 4] = "Error", e[e.EndOfDictation = 5] = "EndOfDictation" }(t.RecognitionStatus || (t.RecognitionStatus = {})) }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var r = n(2), o = function () { function e(e) { this.obj = JSON.parse(e), this.obj.SynthesisStatus = r.SynthesisStatus[this.obj.SynthesisStatus] } return e.FromJSON = function (t) { return new e(t) }, Object.defineProperty(e.prototype, "SynthesisStatus", { get: function () { return this.obj.SynthesisStatus }, enumerable: !0, configurable: !0 }), Object.defineProperty(e.prototype, "FailureReason", { get: function () { return this.obj.FailureReason }, enumerable: !0, configurable: !0 }), e }(); t.TranslationSynthesisEnd = o }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var r = n(8), o = function () { function e(e) { this.translationHypothesis = JSON.parse(e), this.translationHypothesis.Translation.TranslationStatus = r.TranslationStatus[this.translationHypothesis.Translation.TranslationStatus] } return e.FromJSON = function (t) { return new e(t) }, Object.defineProperty(e.prototype, "Duration", { get: function () { return this.translationHypothesis.Duration }, enumerable: !0, configurable: !0 }), Object.defineProperty(e.prototype, "Offset", { get: function () { return this.translationHypothesis.Offset }, enumerable: !0, configurable: !0 }), Object.defineProperty(e.prototype, "Text", { get: function () { return this.translationHypothesis.Text }, enumerable: !0, configurable: !0 }), Object.defineProperty(e.prototype, "Translation", { get: function () { return this.translationHypothesis.Translation }, enumerable: !0, configurable: !0 }), e }(); t.TranslationHypothesis = o }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var r = n(2), o = n(8), i = function () { function e(e) { this.translationPhrase = JSON.parse(e), this.translationPhrase.RecognitionStatus = r.RecognitionStatus[this.translationPhrase.RecognitionStatus], void 0 !== this.translationPhrase.Translation && (this.translationPhrase.Translation.TranslationStatus = o.TranslationStatus[this.translationPhrase.Translation.TranslationStatus]) } return e.FromJSON = function (t) { return new e(t) }, Object.defineProperty(e.prototype, "RecognitionStatus", { get: function () { return this.translationPhrase.RecognitionStatus }, enumerable: !0, configurable: !0 }), Object.defineProperty(e.prototype, "Offset", { get: function () { return this.translationPhrase.Offset }, enumerable: !0, configurable: !0 }), Object.defineProperty(e.prototype, "Duration", { get: function () { return this.translationPhrase.Duration }, enumerable: !0, configurable: !0 }), Object.defineProperty(e.prototype, "Text", { get: function () { return this.translationPhrase.Text }, enumerable: !0, configurable: !0 }), Object.defineProperty(e.prototype, "Translation", { get: function () { return this.translationPhrase.Translation }, enumerable: !0, configurable: !0 }), e }(); t.TranslationPhrase = i }, function (e, t, n) { "use strict"; var r, o = this && this.__extends || (r = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (e, t) { e.__proto__ = t } || function (e, t) { for (var n in t) t.hasOwnProperty(n) && (e[n] = t[n]) }, function (e, t) { function n() { this.constructor = e } r(e, t), e.prototype = null === t ? Object.create(t) : (n.prototype = t.prototype, new n) }); Object.defineProperty(t, "__esModule", { value: !0 }); var i = n(1), s = n(0), c = n(2), a = function (e) { function t(t, n, r, o, i) { var s = e.call(this, t, n, r, o, i) || this; return s.translationRecognizer = i, s } return o(t, e), t.prototype.ProcessTypeSpecificMessages = function (e, t, n, r, o) { switch (e.Path.toLowerCase()) { case "translation.hypothesis": var i = this.FireEventForResult(c.TranslationHypothesis.FromJSON(e.TextBody), t); if (this.translationRecognizer.recognizing) try { this.translationRecognizer.recognizing(this.translationRecognizer, i) } catch (e) { } break; case "translation.phrase": this.recognizerConfig.IsContinuousRecognition && this.SendTelemetryData(t.RequestId, n, t.GetTelemetry()); var a = c.TranslationPhrase.FromJSON(e.TextBody); if (a.RecognitionStatus === c.RecognitionStatus.Success) { var u = this.FireEventForResult(a, t); if (this.translationRecognizer.recognized) try { this.translationRecognizer.recognized(this.translationRecognizer, u) } catch (e) { } if (r) { try { r(u.result) } catch (e) { o && o(e) } r = void 0, o = void 0 } break } var p = c.EnumTranslation.implTranslateRecognitionResult(a.RecognitionStatus), l = new s.TranslationRecognitionResult(void 0, t.RequestId, p, a.Text, a.Duration, a.Offset, void 0, e.TextBody, void 0); if (p === s.ResultReason.Canceled) { var f = c.EnumTranslation.implTranslateCancelResult(a.RecognitionStatus), d = new s.TranslationRecognitionCanceledEventArgs(t.SessionId, f, null, f === s.CancellationReason.Error ? s.CancellationErrorCode.ServiceError : s.CancellationErrorCode.NoError, l); if (this.translationRecognizer.canceled) try { this.translationRecognizer.canceled(this.translationRecognizer, d) } catch (e) { } } else { d = new s.TranslationRecognitionEventArgs(l, 0, t.SessionId); if (this.translationRecognizer.recognized) try { this.translationRecognizer.recognized(this.translationRecognizer, d) } catch (e) { } } if (r) { try { r(l) } catch (e) { o && o(e) } r = void 0, o = void 0 } break; case "translation.synthesis": this.sendSynthesisAudio(e.BinaryBody, t.SessionId); break; case "translation.synthesis.end": var h = c.TranslationSynthesisEnd.FromJSON(e.TextBody); switch (h.SynthesisStatus) { case c.SynthesisStatus.Error: if (this.translationRecognizer.synthesizing) { var g = new s.TranslationSynthesisResult(s.ResultReason.Canceled, void 0), v = new s.TranslationSynthesisEventArgs(g, t.SessionId); try { this.translationRecognizer.synthesizing(this.translationRecognizer, v) } catch (e) { } } if (this.translationRecognizer.canceled) { var y = new s.TranslationRecognitionCanceledEventArgs(t.SessionId, s.CancellationReason.Error, h.FailureReason, s.CancellationErrorCode.ServiceError, null); try { this.translationRecognizer.canceled(this.translationRecognizer, y) } catch (e) { } } break; case c.SynthesisStatus.Success: this.sendSynthesisAudio(void 0, t.SessionId) } } }, t.prototype.ConnectionError = function (e, t, n) { if (this.translationRecognizer.canceled) { var r = new s.PropertyCollection; r.setProperty(c.CancellationErrorCodePropertyName, s.CancellationErrorCode[s.CancellationErrorCode.ConnectionFailure]); var o = new s.TranslationRecognitionResult(void 0, t, s.ResultReason.Canceled, void 0, void 0, void 0, n, void 0, r), i = new s.TranslationRecognitionCanceledEventArgs(e, s.CancellationReason.Error, n, s.CancellationErrorCode.ConnectionFailure, o); try { this.translationRecognizer.canceled(this.translationRecognizer, i) } catch (e) { } } }, t.prototype.FireEventForResult = function (e, t) { var n, r; if (void 0 !== e.Translation.Translations) { n = new s.Translations; for (var o = 0, a = e.Translation.Translations; o < a.length; o++) { var u = a[o]; n.set(u.Language, u.Text) } } r = e instanceof c.TranslationPhrase ? e.Translation.TranslationStatus === i.TranslationStatus.Success ? s.ResultReason.TranslatedSpeech : s.ResultReason.RecognizedSpeech : s.ResultReason.TranslatingSpeech; var p = new s.TranslationRecognitionResult(n, t.RequestId, r, e.Text, e.Duration, e.Offset, e.Translation.FailureReason, JSON.stringify(e), void 0); return new s.TranslationRecognitionEventArgs(p, e.Offset, t.SessionId) }, t.prototype.sendSynthesisAudio = function (e, t) { var n = void 0 === e ? s.ResultReason.SynthesizingAudioCompleted : s.ResultReason.SynthesizingAudio, r = new s.TranslationSynthesisResult(n, e), o = new s.TranslationSynthesisEventArgs(r, t); if (this.translationRecognizer.synthesizing) try { this.translationRecognizer.synthesizing(this.translationRecognizer, o) } catch (e) { } }, t }(c.ServiceRecognizerBase); t.TranslationServiceRecognizer = a }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var r = function () { function e(e) { this.speechStartDetected = JSON.parse(e) } return e.FromJSON = function (t) { return new e(t) }, Object.defineProperty(e.prototype, "Offset", { get: function () { return this.speechStartDetected.Offset }, enumerable: !0, configurable: !0 }), e }(); t.SpeechDetected = r }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var r = function () { function e(e) { this.speechHypothesis = JSON.parse(e) } return e.FromJSON = function (t) { return new e(t) }, Object.defineProperty(e.prototype, "Text", { get: function () { return this.speechHypothesis.Text }, enumerable: !0, configurable: !0 }), Object.defineProperty(e.prototype, "Offset", { get: function () { return this.speechHypothesis.Offset }, enumerable: !0, configurable: !0 }), Object.defineProperty(e.prototype, "Duration", { get: function () { return this.speechHypothesis.Duration }, enumerable: !0, configurable: !0 }), e }(); t.SpeechHypothesis = r }, function (e, t, n) { "use strict"; var r, o = this && this.__extends || (r = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (e, t) { e.__proto__ = t } || function (e, t) { for (var n in t) t.hasOwnProperty(n) && (e[n] = t[n]) }, function (e, t) { function n() { this.constructor = e } r(e, t), e.prototype = null === t ? Object.create(t) : (n.prototype = t.prototype, new n) }); Object.defineProperty(t, "__esModule", { value: !0 }); var i = n(0), s = n(2), c = function (e) { function t(t, n, r, o, i) { var s = e.call(this, t, n, r, o, i) || this; return s.speechRecognizer = i, s } return o(t, e), t.prototype.ProcessTypeSpecificMessages = function (e, t, n, r, o) { var c; switch (e.Path.toLowerCase()) { case "speech.hypothesis": var a = s.SpeechHypothesis.FromJSON(e.TextBody); c = new i.SpeechRecognitionResult(t.RequestId, i.ResultReason.RecognizingSpeech, a.Text, a.Duration, a.Offset, void 0, e.TextBody, void 0); var u = new i.SpeechRecognitionEventArgs(c, a.Duration, t.SessionId); if (this.speechRecognizer.recognizing) try { this.speechRecognizer.recognizing(this.speechRecognizer, u) } catch (e) { } break; case "speech.phrase": this.recognizerConfig.IsContinuousRecognition && this.SendTelemetryData(t.RequestId, n, t.GetTelemetry()); var p = s.SimpleSpeechPhrase.FromJSON(e.TextBody), l = s.EnumTranslation.implTranslateRecognitionResult(p.RecognitionStatus); if (i.ResultReason.Canceled === l) { if (c = new i.SpeechRecognitionResult(t.RequestId, l, void 0, void 0, void 0, void 0, e.TextBody, void 0), this.speechRecognizer.canceled) { var f = new i.SpeechRecognitionCanceledEventArgs(s.EnumTranslation.implTranslateCancelResult(p.RecognitionStatus), void 0, void 0, s.EnumTranslation.implTranslateCancelResult(p.RecognitionStatus) === i.CancellationReason.Error ? i.CancellationErrorCode.ServiceError : i.CancellationErrorCode.NoError, t.SessionId); try { this.speechRecognizer.canceled(this.speechRecognizer, f) } catch (e) { } } } else { if (this.recognizerConfig.parameters.getProperty(s.OutputFormatPropertyName) === i.OutputFormat[i.OutputFormat.Simple]) c = new i.SpeechRecognitionResult(t.RequestId, s.EnumTranslation.implTranslateRecognitionResult(p.RecognitionStatus), p.DisplayText, p.Duration, p.Offset, void 0, e.TextBody, void 0); else { var d = s.DetailedSpeechPhrase.FromJSON(e.TextBody); c = new i.SpeechRecognitionResult(t.RequestId, s.EnumTranslation.implTranslateRecognitionResult(d.RecognitionStatus), d.RecognitionStatus === s.RecognitionStatus.Success ? d.NBest[0].Display : void 0, d.Duration, d.Offset, void 0, e.TextBody, void 0) } var h = new i.SpeechRecognitionEventArgs(c, c.offset, t.SessionId); if (this.speechRecognizer.recognized) try { this.speechRecognizer.recognized(this.speechRecognizer, h) } catch (e) { } } if (r) { try { r(c) } catch (e) { o && o(e) } r = void 0, o = void 0 } } }, t.prototype.ConnectionError = function (e, t, n) { if (this.speechRecognizer.canceled) { (new i.PropertyCollection).setProperty(s.CancellationErrorCodePropertyName, i.CancellationErrorCode[i.CancellationErrorCode.ConnectionFailure]); var r = new i.SpeechRecognitionCanceledEventArgs(i.CancellationReason.Error, n, i.CancellationErrorCode.ConnectionFailure, void 0, e); try { this.speechRecognizer.canceled(this.speechRecognizer, r) } catch (e) { } } }, t }(s.ServiceRecognizerBase); t.SpeechServiceRecognizer = c }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var r = n(2), o = function () { function e(e) { this.detailedSpeechPhrase = JSON.parse(e), this.detailedSpeechPhrase.RecognitionStatus = r.RecognitionStatus[this.detailedSpeechPhrase.RecognitionStatus] } return e.FromJSON = function (t) { return new e(t) }, Object.defineProperty(e.prototype, "RecognitionStatus", { get: function () { return this.detailedSpeechPhrase.RecognitionStatus }, enumerable: !0, configurable: !0 }), Object.defineProperty(e.prototype, "NBest", { get: function () { return this.detailedSpeechPhrase.NBest }, enumerable: !0, configurable: !0 }), Object.defineProperty(e.prototype, "Duration", { get: function () { return this.detailedSpeechPhrase.Duration }, enumerable: !0, configurable: !0 }), Object.defineProperty(e.prototype, "Offset", { get: function () { return this.detailedSpeechPhrase.Offset }, enumerable: !0, configurable: !0 }), e }(); t.DetailedSpeechPhrase = o }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var r = n(2), o = function () { function e(e) { this.simpleSpeechPhrase = JSON.parse(e), this.simpleSpeechPhrase.RecognitionStatus = r.RecognitionStatus[this.simpleSpeechPhrase.RecognitionStatus] } return e.FromJSON = function (t) { return new e(t) }, Object.defineProperty(e.prototype, "RecognitionStatus", { get: function () { return this.simpleSpeechPhrase.RecognitionStatus }, enumerable: !0, configurable: !0 }), Object.defineProperty(e.prototype, "DisplayText", { get: function () { return this.simpleSpeechPhrase.DisplayText }, enumerable: !0, configurable: !0 }), Object.defineProperty(e.prototype, "Offset", { get: function () { return this.simpleSpeechPhrase.Offset }, enumerable: !0, configurable: !0 }), Object.defineProperty(e.prototype, "Duration", { get: function () { return this.simpleSpeechPhrase.Duration }, enumerable: !0, configurable: !0 }), e }(); t.SimpleSpeechPhrase = o }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var r = function () { return function (e, t) { this.modelImpl = e, this.intentName = t } }(); t.AddedLmIntent = r }, function (e, t, n) { "use strict"; var r, o = this && this.__extends || (r = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (e, t) { e.__proto__ = t } || function (e, t) { for (var n in t) t.hasOwnProperty(n) && (e[n] = t[n]) }, function (e, t) { function n() { this.constructor = e } r(e, t), e.prototype = null === t ? Object.create(t) : (n.prototype = t.prototype, new n) }); Object.defineProperty(t, "__esModule", { value: !0 }); var i = n(0), s = n(2), c = function (e) { function t(t, n, r, o, i, s) { var c = e.call(this, t, n, r, o, i) || this; return c.intentRecognizer = i, c.intentDataSent = s, c } return o(t, e), t.prototype.setIntents = function (e, t) { this.addedLmIntents = e, this.umbrellaIntent = t }, t.prototype.ProcessTypeSpecificMessages = function (e, t, n, r, o) { var c, a, u = this; switch (e.Path.toLowerCase()) { case "speech.hypothesis": var p = s.SpeechHypothesis.FromJSON(e.TextBody); if (c = new i.IntentRecognitionResult(void 0, t.RequestId, i.ResultReason.RecognizingIntent, p.Text, p.Duration, p.Offset, void 0, e.TextBody, void 0), a = new i.IntentRecognitionEventArgs(c, p.Offset, t.SessionId), this.intentRecognizer.recognizing) try { this.intentRecognizer.recognizing(this.intentRecognizer, a) } catch (e) { } break; case "speech.phrase": var l = s.SimpleSpeechPhrase.FromJSON(e.TextBody); c = new i.IntentRecognitionResult(void 0, t.RequestId, s.EnumTranslation.implTranslateRecognitionResult(l.RecognitionStatus), l.DisplayText, l.Duration, l.Offset, void 0, e.TextBody, void 0), a = new i.IntentRecognitionEventArgs(c, c.offset, t.SessionId); !1 === this.intentDataSent || i.ResultReason.NoMatch === a.result.reason ? function () { if (u.recognizerConfig.IsContinuousRecognition && u.SendTelemetryData(t.RequestId, n, t.GetTelemetry()), u.intentRecognizer.recognized) try { u.intentRecognizer.recognized(u.intentRecognizer, a) } catch (e) { } if (r) { try { r(c) } catch (e) { o && o(e) } r = void 0, o = void 0 } }() : this.pendingIntentArgs = a; break; case "response": this.recognizerConfig.IsContinuousRecognition && this.SendTelemetryData(t.RequestId, n, t.GetTelemetry()), a = this.pendingIntentArgs, this.pendingIntentArgs = void 0; var f = s.IntentResponse.FromJSON(e.TextBody); void 0 === a && (a = new i.IntentRecognitionEventArgs(new i.IntentRecognitionResult, 0, t.SessionId)); var d = this.addedLmIntents[f.topScoringIntent.intent]; if (void 0 !== this.umbrellaIntent && (d = this.umbrellaIntent), null !== f && void 0 !== d) { var h = void 0 === d.intentName ? f.topScoringIntent.intent : d.intentName, g = a.result.reason; void 0 !== h && (g = i.ResultReason.RecognizedIntent); var v = void 0 !== a.result.properties ? a.result.properties : new i.PropertyCollection; v.setProperty(i.PropertyId.LanguageUnderstandingServiceResponse_JsonResult, e.TextBody), a = new i.IntentRecognitionEventArgs(new i.IntentRecognitionResult(h, a.result.resultId, g, a.result.text, a.result.duration, a.result.offset, a.result.errorDetails, a.result.json, v), a.offset, a.sessionId) } if (this.intentRecognizer.recognized) try { this.intentRecognizer.recognized(this.intentRecognizer, a) } catch (e) { } if (r) { try { r(a.result) } catch (e) { o && o(e) } r = void 0, o = void 0 } } }, t.prototype.ConnectionError = function (e, t, n) { if (this.intentRecognizer.canceled) { var r = new i.PropertyCollection; r.setProperty(s.CancellationErrorCodePropertyName, i.CancellationErrorCode[i.CancellationErrorCode.ConnectionFailure]); new i.IntentRecognitionResult(void 0, t, i.ResultReason.Canceled, void 0, void 0, void 0, n, void 0, r); var o = new i.IntentRecognitionCanceledEventArgs(i.CancellationReason.Error, n, i.CancellationErrorCode.ConnectionFailure, void 0, void 0, e); try { this.intentRecognizer.canceled(this.intentRecognizer, o) } catch (e) { } } }, t }(s.ServiceRecognizerBase); t.IntentServiceRecognizer = c }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var r = function () { function e(e) { this.intentResponse = JSON.parse(e) } return e.FromJSON = function (t) { return new e(t) }, Object.defineProperty(e.prototype, "query", { get: function () { return this.intentResponse.query }, enumerable: !0, configurable: !0 }), Object.defineProperty(e.prototype, "topScoringIntent", { get: function () { return this.intentResponse.topScoringIntent }, enumerable: !0, configurable: !0 }), Object.defineProperty(e.prototype, "entities", { get: function () { return this.intentResponse.entities }, enumerable: !0, configurable: !0 }), e }(); t.IntentResponse = r }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var r = n(1), o = n(10), i = n(79), s = function () { function e(e) { var t = this; this.isDisposed = !1, this.detachables = new Array, this.isAudioNodeDetached = !1, this.isCompleted = !1, this.OnAudioSourceAttachCompleted = function (e, n, r) { t.audioNode = e, n ? t.OnComplete() : t.OnEvent(new o.ListeningStartedEvent(t.requestId, t.sessionId, t.audioSourceId, t.audioNodeId)) }, this.OnPreConnectionStart = function (e, n) { t.authFetchEventId = e, t.sessionId = n, t.OnEvent(new o.ConnectingToServiceEvent(t.requestId, t.authFetchEventId, t.sessionId)) }, this.OnAuthCompleted = function (e, n) { e && t.OnComplete() }, this.OnConnectionEstablishCompleted = function (e, n) { 200 !== e ? t.OnComplete() : t.OnEvent(new o.RecognitionStartedEvent(t.RequestId, t.audioSourceId, t.audioNodeId, t.authFetchEventId, t.sessionId)) }, this.OnServiceTurnEndResponse = function () { t.OnComplete() }, this.Dispose = function (e) { if (!t.isDisposed) { t.isDisposed = !0; for (var n = 0, r = t.detachables; n < r.length; n++) { r[n].Detach() } t.serviceTelemetryListener.Dispose() } }, this.GetTelemetry = function () { return t.serviceTelemetryListener.GetTelemetry() }, this.OnEvent = function (e) { t.serviceTelemetryListener.OnEvent(e), r.Events.Instance.OnEvent(e) }, this.OnComplete = function () { t.isCompleted || (t.isCompleted = !0, t.DetachAudioNode()) }, this.DetachAudioNode = function () { t.isAudioNodeDetached || (t.isAudioNodeDetached = !0, t.audioNode && t.audioNode.Detach()) }, this.audioSourceId = e, this.requestId = r.CreateNoDashGuid(), this.audioNodeId = r.CreateNoDashGuid(), this.requestCompletionDeferral = new r.Deferred, this.serviceTelemetryListener = new i.ServiceTelemetryListener(this.requestId, this.audioSourceId, this.audioNodeId), this.OnEvent(new o.RecognitionTriggeredEvent(this.RequestId, this.sessionId, this.audioSourceId, this.audioNodeId)) } return Object.defineProperty(e.prototype, "SessionId", { get: function () { return this.sessionId }, enumerable: !0, configurable: !0 }), Object.defineProperty(e.prototype, "RequestId", { get: function () { return this.requestId }, enumerable: !0, configurable: !0 }), Object.defineProperty(e.prototype, "AudioNodeId", { get: function () { return this.audioNodeId }, enumerable: !0, configurable: !0 }), Object.defineProperty(e.prototype, "CompletionPromise", { get: function () { return this.requestCompletionDeferral.Promise() }, enumerable: !0, configurable: !0 }), Object.defineProperty(e.prototype, "IsSpeechEnded", { get: function () { return this.isAudioNodeDetached }, enumerable: !0, configurable: !0 }), Object.defineProperty(e.prototype, "IsCompleted", { get: function () { return this.isCompleted }, enumerable: !0, configurable: !0 }), e.prototype.ListenForServiceTelemetry = function (e) { this.detachables.push(e.AttachListener(this.serviceTelemetryListener)) }, e }(); t.RequestSession = s }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var r = n(1), o = n(10), i = function () { return function (e, t, n) { var i = this; this.isDisposed = !1, this.listeningTriggerMetric = null, this.micMetric = null, this.connectionEstablishMetric = null, this.OnEvent = function (e) { i.isDisposed || (e instanceof o.RecognitionTriggeredEvent && e.RequestId === i.requestId && (i.listeningTriggerMetric = { End: e.EventTime, Name: "ListeningTrigger", Start: e.EventTime }), e instanceof r.AudioStreamNodeAttachingEvent && e.AudioSourceId === i.audioSourceId && e.AudioNodeId === i.audioNodeId && (i.micStartTime = e.EventTime), e instanceof r.AudioStreamNodeAttachedEvent && e.AudioSourceId === i.audioSourceId && e.AudioNodeId === i.audioNodeId && (i.micStartTime = e.EventTime), e instanceof r.AudioSourceErrorEvent && e.AudioSourceId === i.audioSourceId && (i.micMetric || (i.micMetric = { End: e.EventTime, Error: e.Error, Name: "Microphone", Start: i.micStartTime })), e instanceof r.AudioStreamNodeErrorEvent && e.AudioSourceId === i.audioSourceId && e.AudioNodeId === i.audioNodeId && (i.micMetric || (i.micMetric = { End: e.EventTime, Error: e.Error, Name: "Microphone", Start: i.micStartTime })), e instanceof r.AudioStreamNodeDetachedEvent && e.AudioSourceId === i.audioSourceId && e.AudioNodeId === i.audioNodeId && (i.micMetric || (i.micMetric = { End: e.EventTime, Name: "Microphone", Start: i.micStartTime })), e instanceof o.ConnectingToServiceEvent && e.RequestId === i.requestId && (i.connectionId = e.SessionId), e instanceof r.ConnectionStartEvent && e.ConnectionId === i.connectionId && (i.connectionStartTime = e.EventTime), e instanceof r.ConnectionEstablishedEvent && e.ConnectionId === i.connectionId && (i.connectionEstablishMetric || (i.connectionEstablishMetric = { End: e.EventTime, Id: i.connectionId, Name: "Connection", Start: i.connectionStartTime })), e instanceof r.ConnectionEstablishErrorEvent && e.ConnectionId === i.connectionId && (i.connectionEstablishMetric || (i.connectionEstablishMetric = { End: e.EventTime, Error: i.GetConnectionError(e.StatusCode), Id: i.connectionId, Name: "Connection", Start: i.connectionStartTime })), e instanceof r.ConnectionMessageReceivedEvent && e.ConnectionId === i.connectionId && e.Message && e.Message.Headers && e.Message.Headers.path && (i.receivedMessages[e.Message.Headers.path] || (i.receivedMessages[e.Message.Headers.path] = new Array), i.receivedMessages[e.Message.Headers.path].push(e.NetworkReceivedTime))) }, this.GetTelemetry = function () { var e = new Array; i.listeningTriggerMetric && e.push(i.listeningTriggerMetric), i.micMetric && e.push(i.micMetric), i.connectionEstablishMetric && e.push(i.connectionEstablishMetric); var t = { Metrics: e, ReceivedMessages: i.receivedMessages }, n = JSON.stringify(t); return i.receivedMessages = {}, i.listeningTriggerMetric = null, i.micMetric = null, i.connectionEstablishMetric = null, n }, this.Dispose = function () { i.isDisposed = !0 }, this.GetConnectionError = function (e) { switch (e) { case 400: case 1002: case 1003: case 1005: case 1007: case 1008: case 1009: return "BadRequest"; case 401: return "Unauthorized"; case 403: return "Forbidden"; case 503: case 1001: return "ServerUnavailable"; case 500: case 1011: return "ServerError"; case 408: case 504: return "Timeout"; default: return "statuscode:" + e.toString() } }, this.requestId = e, this.audioSourceId = t, this.audioNodeId = n, this.receivedMessages = {} } }(); t.ServiceTelemetryListener = i }, function (e, t, n) { "use strict"; var r, o = this && this.__extends || (r = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (e, t) { e.__proto__ = t } || function (e, t) { for (var n in t) t.hasOwnProperty(n) && (e[n] = t[n]) }, function (e, t) { function n() { this.constructor = e } r(e, t), e.prototype = null === t ? Object.create(t) : (n.prototype = t.prototype, new n) }); Object.defineProperty(t, "__esModule", { value: !0 }); var i = n(2), s = n(4), c = n(0), a = function (e) { function t() { return e.call(this) || this } return o(t, e), t.fromSubscription = function (e, t) { s.Contracts.throwIfNullOrWhitespace(e, "subscriptionKey"), s.Contracts.throwIfNullOrWhitespace(t, "region"); var n = new u; return n.properties.setProperty(c.PropertyId.SpeechServiceConnection_Key, e), n.properties.setProperty(c.PropertyId.SpeechServiceConnection_Region, t), n }, t.fromAuthorizationToken = function (e, t) { s.Contracts.throwIfNullOrWhitespace(e, "authorizationToken"), s.Contracts.throwIfNullOrWhitespace(t, "region"); var n = new u; return n.properties.setProperty(c.PropertyId.SpeechServiceAuthorization_Token, e), n.properties.setProperty(c.PropertyId.SpeechServiceConnection_Region, t), n }, t.fromEndpoint = function (e, t) { s.Contracts.throwIfNull(e, "endpoint"), s.Contracts.throwIfNullOrWhitespace(t, "subscriptionKey"); var n = new u; return n.properties.setProperty(c.PropertyId.SpeechServiceConnection_Endpoint, e.href), n.properties.setProperty(c.PropertyId.SpeechServiceConnection_Key, t), n }, t }(c.SpeechConfig); t.SpeechTranslationConfig = a; var u = function (e) { function t() { var t = e.call(this) || this; return t.speechProperties = new c.PropertyCollection, t } return o(t, e), Object.defineProperty(t.prototype, "authorizationToken", { set: function (e) { s.Contracts.throwIfNullOrWhitespace(e, "value"), this.properties.setProperty(c.PropertyId.SpeechServiceAuthorization_Token, e) }, enumerable: !0, configurable: !0 }), Object.defineProperty(t.prototype, "speechRecognitionLanguage", { set: function (e) { s.Contracts.throwIfNullOrWhitespace(e, "value"), this.properties.setProperty(c.PropertyId.SpeechServiceConnection_RecoLanguage, e) }, enumerable: !0, configurable: !0 }), Object.defineProperty(t.prototype, "subscriptionKey", { get: function () { return this.speechProperties.getProperty(c.PropertyId[c.PropertyId.SpeechServiceConnection_Key]) }, enumerable: !0, configurable: !0 }), Object.defineProperty(t.prototype, "outputFormat", { get: function () { return c.OutputFormat[this.speechProperties.getProperty(i.OutputFormatPropertyName, c.OutputFormat[c.OutputFormat.Simple])] }, set: function (e) { this.speechProperties.setProperty(i.OutputFormatPropertyName, c.OutputFormat[e]) }, enumerable: !0, configurable: !0 }), Object.defineProperty(t.prototype, "endpointId", { get: function () { return this.speechProperties.getProperty(c.PropertyId.SpeechServiceConnection_EndpointId) }, set: function (e) { this.speechProperties.setProperty(c.PropertyId.SpeechServiceConnection_Endpoint, e) }, enumerable: !0, configurable: !0 }), t.prototype.addTargetLanguage = function (e) { s.Contracts.throwIfNullOrWhitespace(e, "value"); var t = this.targetLanguages; t.push(e), this.properties.setProperty(c.PropertyId.SpeechServiceConnection_TranslationToLanguages, t.join(",")) }, Object.defineProperty(t.prototype, "targetLanguages", { get: function () { return void 0 !== this.speechProperties.getProperty(c.PropertyId.SpeechServiceConnection_TranslationToLanguages, void 0) ? this.speechProperties.getProperty(c.PropertyId.SpeechServiceConnection_TranslationToLanguages).split(",") : [] }, enumerable: !0, configurable: !0 }), Object.defineProperty(t.prototype, "voiceName", { get: function () { return this.getProperty(c.PropertyId[c.PropertyId.SpeechServiceConnection_TranslationVoice]) }, set: function (e) { s.Contracts.throwIfNullOrWhitespace(e, "value"), this.properties.setProperty(c.PropertyId.SpeechServiceConnection_TranslationVoice, e) }, enumerable: !0, configurable: !0 }), Object.defineProperty(t.prototype, "region", { get: function () { return this.speechProperties.getProperty(c.PropertyId.SpeechServiceConnection_Region) }, enumerable: !0, configurable: !0 }), t.prototype.setProperty = function (e, t) { this.properties.setProperty(e, t) }, t.prototype.getProperty = function (e, t) { return this.speechProperties.getProperty(e, t) }, Object.defineProperty(t.prototype, "properties", { get: function () { return this.speechProperties }, enumerable: !0, configurable: !0 }), t.prototype.close = function () { }, t }(a); t.SpeechTranslationConfigImpl = u }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var r = n(0), o = function () { function e() { this.keys = [], this.values = [] } return e.prototype.getProperty = function (e, t) { var n; n = "string" == typeof e ? e : r.PropertyId[e]; for (var o = 0; o < this.keys.length; o++)if (this.keys[o] === n) return this.values[o]; return t }, e.prototype.setProperty = function (e, t) { var n; n = "string" == typeof e ? e : r.PropertyId[e]; for (var o = 0; o < this.keys.length; o++)if (this.keys[o] === n) return void (this.values[o] = t); this.keys.push(n), this.values.push(t) }, e.prototype.clone = function () { for (var t = new e, n = 0; n < this.keys.length; n++)t.keys.push(this.keys[n]), t.values.push(this.values[n]); return t }, e }(); t.PropertyCollection = o }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }), function (e) { e[e.SpeechServiceConnection_Key = 0] = "SpeechServiceConnection_Key", e[e.SpeechServiceConnection_Endpoint = 1] = "SpeechServiceConnection_Endpoint", e[e.SpeechServiceConnection_Region = 2] = "SpeechServiceConnection_Region", e[e.SpeechServiceAuthorization_Token = 3] = "SpeechServiceAuthorization_Token", e[e.SpeechServiceAuthorization_Type = 4] = "SpeechServiceAuthorization_Type", e[e.SpeechServiceConnection_EndpointId = 5] = "SpeechServiceConnection_EndpointId", e[e.SpeechServiceConnection_TranslationToLanguages = 6] = "SpeechServiceConnection_TranslationToLanguages", e[e.SpeechServiceConnection_TranslationVoice = 7] = "SpeechServiceConnection_TranslationVoice", e[e.SpeechServiceConnection_TranslationFeatures = 8] = "SpeechServiceConnection_TranslationFeatures", e[e.SpeechServiceConnection_IntentRegion = 9] = "SpeechServiceConnection_IntentRegion", e[e.SpeechServiceConnection_RecoMode = 10] = "SpeechServiceConnection_RecoMode", e[e.SpeechServiceConnection_RecoLanguage = 11] = "SpeechServiceConnection_RecoLanguage", e[e.Speech_SessionId = 12] = "Speech_SessionId", e[e.SpeechServiceResponse_RequestDetailedResultTrueFalse = 13] = "SpeechServiceResponse_RequestDetailedResultTrueFalse", e[e.SpeechServiceResponse_RequestProfanityFilterTrueFalse = 14] = "SpeechServiceResponse_RequestProfanityFilterTrueFalse", e[e.SpeechServiceResponse_JsonResult = 15] = "SpeechServiceResponse_JsonResult", e[e.SpeechServiceResponse_JsonErrorDetails = 16] = "SpeechServiceResponse_JsonErrorDetails", e[e.CancellationDetails_Reason = 17] = "CancellationDetails_Reason", e[e.CancellationDetails_ReasonText = 18] = "CancellationDetails_ReasonText", e[e.CancellationDetails_ReasonDetailedText = 19] = "CancellationDetails_ReasonDetailedText", e[e.LanguageUnderstandingServiceResponse_JsonResult = 20] = "LanguageUnderstandingServiceResponse_JsonResult" }(t.PropertyId || (t.PropertyId = {})) }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var r = n(2), o = n(1), i = n(4), s = n(0), c = function () { function e(e) { this.audioConfig = void 0 !== e ? e : s.AudioConfig.fromDefaultMicrophoneInput(), this.disposed = !1 } return e.prototype.close = function () { i.Contracts.throwIfDisposed(this.disposed), this.dispose(!0) }, e.prototype.dispose = function (e) { this.disposed || (this.disposed = !0) }, e.prototype.implRecognizerSetup = function (e, t, n, i) { var c = void 0 !== window ? "Browser" : "Node", a = "unknown", u = "unknown"; void 0 !== navigator && (c = c + "/" + navigator.platform, a = navigator.userAgent, u = navigator.appVersion); var p = this.CreateRecognizerConfig(new r.PlatformConfig(new r.Context(new r.OS(c, a, u))), e), l = t.getProperty(s.PropertyId.SpeechServiceConnection_Key, void 0), f = l ? new r.CognitiveSubscriptionKeyAuthentication(l) : new r.CognitiveTokenAuthentication(function (e) { var n = t.getProperty(s.PropertyId.SpeechServiceAuthorization_Token, void 0); return o.PromiseHelper.FromResult(n) }, function (e) { var n = t.getProperty(s.PropertyId.SpeechServiceAuthorization_Token, void 0); return o.PromiseHelper.FromResult(n) }); return this.CreateServiceRecognizer(f, i, n, p) }, e.prototype.implRecognizerStart = function (e, t, n, r) { e.Recognize(r, t, n).On(function (e) { }, function (e) { n && n("Runtime error: " + e) }) }, e }(); t.Recognizer = c }, function (e, t, n) { "use strict"; var r, o = this && this.__extends || (r = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (e, t) { e.__proto__ = t } || function (e, t) { for (var n in t) t.hasOwnProperty(n) && (e[n] = t[n]) }, function (e, t) { function n() { this.constructor = e } r(e, t), e.prototype = null === t ? Object.create(t) : (n.prototype = t.prototype, new n) }); Object.defineProperty(t, "__esModule", { value: !0 }); var i = n(2), s = n(19), c = n(4), a = n(0), u = function (e) { function t(t, n) { var r = e.call(this, n) || this; r.disposedSpeechRecognizer = !1; var o = t; return c.Contracts.throwIfNull(o, "speechConfig"), r.privProperties = o.properties.clone(), c.Contracts.throwIfNullOrWhitespace(o.properties.getProperty(a.PropertyId.SpeechServiceConnection_RecoLanguage), a.PropertyId[a.PropertyId.SpeechServiceConnection_RecoLanguage]), r } return o(t, e), Object.defineProperty(t.prototype, "endpointId", { get: function () { return c.Contracts.throwIfDisposed(this.disposedSpeechRecognizer), this.properties.getProperty(a.PropertyId.SpeechServiceConnection_EndpointId, "00000000-0000-0000-0000-000000000000") }, enumerable: !0, configurable: !0 }), Object.defineProperty(t.prototype, "authorizationToken", { get: function () { return this.properties.getProperty(a.PropertyId.SpeechServiceAuthorization_Token) }, set: function (e) { c.Contracts.throwIfNullOrWhitespace(e, "token"), this.properties.setProperty(a.PropertyId.SpeechServiceAuthorization_Token, e) }, enumerable: !0, configurable: !0 }), Object.defineProperty(t.prototype, "speechRecognitionLanguage", { get: function () { return c.Contracts.throwIfDisposed(this.disposedSpeechRecognizer), this.properties.getProperty(a.PropertyId.SpeechServiceConnection_RecoLanguage) }, enumerable: !0, configurable: !0 }), Object.defineProperty(t.prototype, "outputFormat", { get: function () { return c.Contracts.throwIfDisposed(this.disposedSpeechRecognizer), this.properties.getProperty(i.OutputFormatPropertyName, a.OutputFormat[a.OutputFormat.Simple]) === a.OutputFormat[a.OutputFormat.Simple] ? a.OutputFormat.Simple : a.OutputFormat.Detailed }, enumerable: !0, configurable: !0 }), Object.defineProperty(t.prototype, "properties", { get: function () { return this.privProperties }, enumerable: !0, configurable: !0 }), t.prototype.recognizeOnceAsync = function (e, t) { try { c.Contracts.throwIfDisposed(this.disposedSpeechRecognizer), this.implCloseExistingRecognizer(), this.reco = this.implRecognizerSetup(i.RecognitionMode.Interactive, this.properties, this.audioConfig, new s.SpeechConnectionFactory), this.implRecognizerStart(this.reco, e, t) } catch (e) { if (t) if (e instanceof Error) { var n = e; t(n.name + ": " + n.message) } else t(e) } }, t.prototype.startContinuousRecognitionAsync = function (e, t) { try { if (c.Contracts.throwIfDisposed(this.disposedSpeechRecognizer), this.implCloseExistingRecognizer(), this.reco = this.implRecognizerSetup(i.RecognitionMode.Conversation, this.properties, this.audioConfig, new s.SpeechConnectionFactory), this.implRecognizerStart(this.reco, void 0, void 0), e) { try { e() } catch (e) { t && t(e) } e = void 0 } } catch (e) { if (t) if (e instanceof Error) { var n = e; t(n.name + ": " + n.message) } else t(e) } }, t.prototype.stopContinuousRecognitionAsync = function (e, t) { try { if (c.Contracts.throwIfDisposed(this.disposedSpeechRecognizer), this.implCloseExistingRecognizer(), e) try { e() } catch (e) { t && t(e) } } catch (e) { if (t) if (e instanceof Error) { var n = e; t(n.name + ": " + n.message) } else t(e) } }, t.prototype.startKeywordRecognitionAsync = function (e, t, n) { c.Contracts.throwIfNull(e, "model"), n && n("Not yet implemented.") }, t.prototype.stopKeywordRecognitionAsync = function (e, t) { e && e() }, t.prototype.close = function () { c.Contracts.throwIfDisposed(this.disposedSpeechRecognizer), this.dispose(!0) }, t.prototype.dispose = function (t) { this.disposedSpeechRecognizer || (t && (this.implCloseExistingRecognizer(), this.disposedSpeechRecognizer = !0), e.prototype.dispose.call(this, t)) }, t.prototype.CreateRecognizerConfig = function (e, t) { return new i.RecognizerConfig(e, t, this.properties) }, t.prototype.CreateServiceRecognizer = function (e, t, n, r) { var o = n; return new i.SpeechServiceRecognizer(e, t, o, r, this) }, t.prototype.implCloseExistingRecognizer = function () { this.reco && (this.reco.AudioSource.TurnOff(), this.reco.Dispose(), this.reco = void 0) }, t }(a.Recognizer); t.SpeechRecognizer = u }, function (e, t, n) { "use strict"; var r, o = this && this.__extends || (r = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (e, t) { e.__proto__ = t } || function (e, t) { for (var n in t) t.hasOwnProperty(n) && (e[n] = t[n]) }, function (e, t) { function n() { this.constructor = e } r(e, t), e.prototype = null === t ? Object.create(t) : (n.prototype = t.prototype, new n) }); Object.defineProperty(t, "__esModule", { value: !0 }); var i = n(2), s = n(4), c = n(0), a = function (e) { function t(t, n) { var r = this; s.Contracts.throwIfNullOrUndefined(t, "speechConfig"); var o = t; return s.Contracts.throwIfNullOrUndefined(o, "speechConfig"), (r = e.call(this, n) || this).intentDataSent = !1, r.addedIntents = [], r.addedLmIntents = {}, r.disposedIntentRecognizer = !1, r.privProperties = o.properties, s.Contracts.throwIfNullOrWhitespace(r.properties.getProperty(c.PropertyId.SpeechServiceConnection_RecoLanguage), c.PropertyId[c.PropertyId.SpeechServiceConnection_RecoLanguage]), r } return o(t, e), Object.defineProperty(t.prototype, "speechRecognitionLanguage", { get: function () { return s.Contracts.throwIfDisposed(this.disposedIntentRecognizer), this.properties.getProperty(c.PropertyId.SpeechServiceConnection_RecoLanguage) }, enumerable: !0, configurable: !0 }), Object.defineProperty(t.prototype, "authorizationToken", { get: function () { return this.properties.getProperty(c.PropertyId.SpeechServiceAuthorization_Token) }, set: function (e) { this.properties.setProperty(c.PropertyId.SpeechServiceAuthorization_Token, e) }, enumerable: !0, configurable: !0 }), Object.defineProperty(t.prototype, "properties", { get: function () { return this.privProperties }, enumerable: !0, configurable: !0 }), t.prototype.recognizeOnceAsync = function (e, t) { try { s.Contracts.throwIfDisposed(this.disposedIntentRecognizer), this.implCloseExistingRecognizer(); var n = void 0; 0 === Object.keys(this.addedLmIntents).length && void 0 === this.umbrellaIntent || (n = this.buildSpeechContext(), this.intentDataSent = !0), this.reco = this.implRecognizerSetup(i.RecognitionMode.Interactive, this.properties, this.audioConfig, new i.IntentConnectionFactory), this.reco.setIntents(this.addedLmIntents, this.umbrellaIntent), this.implRecognizerStart(this.reco, e, t, n) } catch (e) { if (t) if (e instanceof Error) { var r = e; t(r.name + ": " + r.message) } else t(e) } }, t.prototype.startContinuousRecognitionAsync = function (e, t) { try { s.Contracts.throwIfDisposed(this.disposedIntentRecognizer), this.implCloseExistingRecognizer(); var n = void 0; if (0 !== Object.keys(this.addedLmIntents).length && (n = this.buildSpeechContext(), this.intentDataSent = !0), this.reco = this.implRecognizerSetup(i.RecognitionMode.Conversation, this.properties, this.audioConfig, new i.IntentConnectionFactory), this.reco.setIntents(this.addedLmIntents, this.umbrellaIntent), this.implRecognizerStart(this.reco, void 0, void 0, n), e) { try { e() } catch (e) { t && t(e) } e = void 0 } } catch (e) { if (t) if (e instanceof Error) { var r = e; t(r.name + ": " + r.message) } else t(e) } }, t.prototype.stopContinuousRecognitionAsync = function (e, t) { try { if (s.Contracts.throwIfDisposed(this.disposedIntentRecognizer), this.implCloseExistingRecognizer(), e) try { e() } catch (e) { t && t(e) } } catch (e) { if (t) if (e instanceof Error) { var n = e; t(n.name + ": " + n.message) } else t(e) } }, t.prototype.startKeywordRecognitionAsync = function (e, t, n) { s.Contracts.throwIfNull(e, "model"), n && n("Not yet implemented.") }, t.prototype.stopKeywordRecognitionAsync = function (e, t) { e && e() }, t.prototype.addIntent = function (e, t) { s.Contracts.throwIfDisposed(this.disposedIntentRecognizer), s.Contracts.throwIfNullOrWhitespace(t, "intentId"), s.Contracts.throwIfNullOrWhitespace(e, "simplePhrase"), this.addedIntents.push([t, e]) }, t.prototype.addIntentWithLanguageModel = function (e, t, n) { s.Contracts.throwIfDisposed(this.disposedIntentRecognizer), s.Contracts.throwIfNullOrWhitespace(e, "intentId"), s.Contracts.throwIfNull(t, "model"); var r = t; s.Contracts.throwIfNullOrWhitespace(r.appId, "model.appId"), this.addedLmIntents[e] = new i.AddedLmIntent(r, n) }, t.prototype.addAllIntents = function (e, t) { s.Contracts.throwIfNull(e, "model"); var n = e; s.Contracts.throwIfNullOrWhitespace(n.appId, "model.appId"), this.umbrellaIntent = new i.AddedLmIntent(n, t) }, t.prototype.close = function () { s.Contracts.throwIfDisposed(this.disposedIntentRecognizer), this.dispose(!0) }, t.prototype.CreateRecognizerConfig = function (e, t) { return new i.RecognizerConfig(e, t, this.properties) }, t.prototype.CreateServiceRecognizer = function (e, t, n, r) { var o = n; return new i.IntentServiceRecognizer(e, t, o, r, this, this.intentDataSent) }, t.prototype.dispose = function (t) { this.disposedIntentRecognizer || t && (this.disposedIntentRecognizer = !0, e.prototype.dispose.call(this, t)) }, t.prototype.implCloseExistingRecognizer = function () { this.reco && (this.reco.AudioSource.TurnOff(), this.reco.Dispose(), this.reco = void 0) }, t.prototype.buildSpeechContext = function () { var e, t, n, r = []; void 0 !== this.umbrellaIntent && (e = this.umbrellaIntent.modelImpl.appId, t = this.umbrellaIntent.modelImpl.region, n = this.umbrellaIntent.modelImpl.subscriptionKey); for (var o = 0, i = Object.keys(this.addedLmIntents); o < i.length; o++) { var s = i[o], a = this.addedLmIntents[s]; if (void 0 === e) e = a.modelImpl.appId; else if (e !== a.modelImpl.appId) throw new Error("Intents must all be from the same LUIS model"); if (void 0 === t) t = a.modelImpl.region; else if (t !== a.modelImpl.region) throw new Error("Intents must all be from the same LUIS model in a single region"); if (void 0 === n) n = a.modelImpl.subscriptionKey; else if (n !== a.modelImpl.subscriptionKey) throw new Error("Intents must all use the same subscription key"); var u = "luis/" + e + "-PRODUCTION#" + s; r.push(u) } return JSON.stringify({ dgi: { ReferenceGrammars: void 0 === this.umbrellaIntent ? r : ["luis/" + e + "-PRODUCTION"] }, intent: { id: e, key: void 0 === n ? this.privProperties.getProperty(c.PropertyId[c.PropertyId.SpeechServiceConnection_Key]) : n, provider: "LUIS" } }) }, t }(c.Recognizer); t.IntentRecognizer = a }, function (e, t, n) { "use strict"; var r, o = this && this.__extends || (r = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (e, t) { e.__proto__ = t } || function (e, t) { for (var n in t) t.hasOwnProperty(n) && (e[n] = t[n]) }, function (e, t) { function n() { this.constructor = e } r(e, t), e.prototype = null === t ? Object.create(t) : (n.prototype = t.prototype, new n) }); Object.defineProperty(t, "__esModule", { value: !0 }); var i = n(2), s = n(4), c = n(0), a = function (e) { function t(t, n) { var r = this, o = t; return s.Contracts.throwIfNull(o, "speechConfig"), (r = e.call(this, n) || this).disposedTranslationRecognizer = !1, r.privProperties = o.properties.clone(), void 0 !== r.properties.getProperty(c.PropertyId.SpeechServiceConnection_TranslationVoice, void 0) && s.Contracts.throwIfNullOrWhitespace(r.properties.getProperty(c.PropertyId.SpeechServiceConnection_TranslationVoice), c.PropertyId[c.PropertyId.SpeechServiceConnection_TranslationVoice]), s.Contracts.throwIfNullOrWhitespace(r.properties.getProperty(c.PropertyId.SpeechServiceConnection_TranslationToLanguages), c.PropertyId[c.PropertyId.SpeechServiceConnection_TranslationToLanguages]), s.Contracts.throwIfNullOrWhitespace(r.properties.getProperty(c.PropertyId.SpeechServiceConnection_RecoLanguage), c.PropertyId[c.PropertyId.SpeechServiceConnection_RecoLanguage]), r } return o(t, e), Object.defineProperty(t.prototype, "speechRecognitionLanguage", { get: function () { return s.Contracts.throwIfDisposed(this.disposedTranslationRecognizer), this.properties.getProperty(c.PropertyId.SpeechServiceConnection_RecoLanguage) }, enumerable: !0, configurable: !0 }), Object.defineProperty(t.prototype, "targetLanguages", { get: function () { return s.Contracts.throwIfDisposed(this.disposedTranslationRecognizer), this.properties.getProperty(c.PropertyId.SpeechServiceConnection_TranslationToLanguages).split(",") }, enumerable: !0, configurable: !0 }), Object.defineProperty(t.prototype, "voiceName", { get: function () { return s.Contracts.throwIfDisposed(this.disposedTranslationRecognizer), this.properties.getProperty(c.PropertyId.SpeechServiceConnection_TranslationVoice, void 0) }, enumerable: !0, configurable: !0 }), Object.defineProperty(t.prototype, "authorizationToken", { get: function () { return this.properties.getProperty(c.PropertyId.SpeechServiceAuthorization_Token) }, set: function (e) { this.properties.setProperty(c.PropertyId.SpeechServiceAuthorization_Token, e) }, enumerable: !0, configurable: !0 }), Object.defineProperty(t.prototype, "properties", { get: function () { return this.privProperties }, enumerable: !0, configurable: !0 }), t.prototype.recognizeOnceAsync = function (e, t) { try { s.Contracts.throwIfDisposed(this.disposedTranslationRecognizer), this.implCloseExistingRecognizer(), this.reco = this.implRecognizerSetup(i.RecognitionMode.Conversation, this.properties, this.audioConfig, new i.TranslationConnectionFactory), this.implRecognizerStart(this.reco, e, t) } catch (e) { if (t) if (e instanceof Error) { var n = e; t(n.name + ": " + n.message) } else t(e) } }, t.prototype.startContinuousRecognitionAsync = function (e, t) { try { if (s.Contracts.throwIfDisposed(this.disposedTranslationRecognizer), this.implCloseExistingRecognizer(), this.reco = this.implRecognizerSetup(i.RecognitionMode.Conversation, this.properties, this.audioConfig, new i.TranslationConnectionFactory), this.implRecognizerStart(this.reco, void 0, void 0), e) { try { e() } catch (e) { t && t(e) } e = void 0 } } catch (e) { if (t) if (e instanceof Error) { var n = e; t(n.name + ": " + n.message) } else t(e) } }, t.prototype.stopContinuousRecognitionAsync = function (e, t) { try { if (s.Contracts.throwIfDisposed(this.disposedTranslationRecognizer), this.implCloseExistingRecognizer(), e) try { e() } catch (e) { t && t(e) } } catch (e) { if (t) if (e instanceof Error) { var n = e; t(n.name + ": " + n.message) } else t(e) } }, t.prototype.close = function () { s.Contracts.throwIfDisposed(this.disposedTranslationRecognizer), this.dispose(!0) }, t.prototype.dispose = function (t) { this.disposedTranslationRecognizer || t && (this.implCloseExistingRecognizer(), this.disposedTranslationRecognizer = !0, e.prototype.dispose.call(this, t)) }, t.prototype.CreateRecognizerConfig = function (e, t) { return new i.RecognizerConfig(e, i.RecognitionMode.Conversation, this.properties) }, t.prototype.CreateServiceRecognizer = function (e, t, n, r) { var o = n; return new i.TranslationServiceRecognizer(e, t, o, r, this) }, t.prototype.implCloseExistingRecognizer = function () { this.reco && (this.reco.AudioSource.TurnOff(), this.reco.Dispose(), this.reco = void 0) }, t }(c.Recognizer); t.TranslationRecognizer = a }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var r = n(0), o = function () { function e() { this.map = new r.PropertyCollection } return e.prototype.get = function (e, t) { return this.map.getProperty(e, t) }, e.prototype.set = function (e, t) { this.map.setProperty(e, t) }, e }(); t.Translations = o }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }), function (e) { e[e.NotRecognized = 0] = "NotRecognized", e[e.InitialSilenceTimeout = 1] = "InitialSilenceTimeout", e[e.InitialBabbleTimeout = 2] = "InitialBabbleTimeout" }(t.NoMatchReason || (t.NoMatchReason = {})) }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var r = n(2), o = n(0), i = function () { function e(e) { this.privReason = e } return e.fromResult = function (t) { var n = r.SimpleSpeechPhrase.FromJSON(t.json), i = o.NoMatchReason.NotRecognized; switch (n.RecognitionStatus) { case r.RecognitionStatus.BabbleTimeout: i = o.NoMatchReason.InitialBabbleTimeout; break; case r.RecognitionStatus.InitialSilenceTimeout: i = o.NoMatchReason.InitialSilenceTimeout; break; default: i = o.NoMatchReason.NotRecognized }return new e(i) }, Object.defineProperty(e.prototype, "reason", { get: function () { return this.privReason }, enumerable: !0, configurable: !0 }), e }(); t.NoMatchDetails = i }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var r = function () { function e(e, t, n, r, o) { this.privCancelReason = t, this.privErrorDetails = n, this.privResult = o, this.privSessionId = e, this.privErrorCode = r } return Object.defineProperty(e.prototype, "result", { get: function () { return this.privResult }, enumerable: !0, configurable: !0 }), Object.defineProperty(e.prototype, "sessionId", { get: function () { return this.privSessionId }, enumerable: !0, configurable: !0 }), Object.defineProperty(e.prototype, "reason", { get: function () { return this.privCancelReason }, enumerable: !0, configurable: !0 }), Object.defineProperty(e.prototype, "errorCode", { get: function () { return this.privErrorCode }, enumerable: !0, configurable: !0 }), Object.defineProperty(e.prototype, "errorDetails", { get: function () { return this.privErrorDetails }, enumerable: !0, configurable: !0 }), e }(); t.TranslationRecognitionCanceledEventArgs = r }, function (e, t, n) { "use strict"; var r, o = this && this.__extends || (r = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (e, t) { e.__proto__ = t } || function (e, t) { for (var n in t) t.hasOwnProperty(n) && (e[n] = t[n]) }, function (e, t) { function n() { this.constructor = e } r(e, t), e.prototype = null === t ? Object.create(t) : (n.prototype = t.prototype, new n) }); Object.defineProperty(t, "__esModule", { value: !0 }); var i = function (e) { function t(t, n, r, o, i, s) { var c = e.call(this, o, i, s) || this; return c.privReason = t, c.privErrorDetails = n, c.privErrorCode = r, c } return o(t, e), Object.defineProperty(t.prototype, "reason", { get: function () { return this.privReason }, enumerable: !0, configurable: !0 }), Object.defineProperty(t.prototype, "errorCode", { get: function () { return this.privErrorCode }, enumerable: !0, configurable: !0 }), Object.defineProperty(t.prototype, "errorDetails", { get: function () { return this.privErrorDetails }, enumerable: !0, configurable: !0 }), t }(n(0).IntentRecognitionEventArgs); t.IntentRecognitionCanceledEventArgs = i }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var r = n(2), o = n(0), i = function () { function e(e, t, n) { this.privReason = e, this.privErrorDetails = t, this.privErrorCode = n } return e.fromResult = function (t) { var n = o.CancellationReason.Error, i = o.CancellationErrorCode.NoError; if (t.json) { var s = r.SimpleSpeechPhrase.FromJSON(t.json); n = r.EnumTranslation.implTranslateCancelResult(s.RecognitionStatus) } return t.properties && (i = o.CancellationErrorCode[t.properties.getProperty(r.CancellationErrorCodePropertyName, o.CancellationErrorCode[o.CancellationErrorCode.NoError])]), new e(n, t.errorDetails, i) }, Object.defineProperty(e.prototype, "reason", { get: function () { return this.privReason }, enumerable: !0, configurable: !0 }), Object.defineProperty(e.prototype, "errorDetails", { get: function () { return this.privErrorDetails }, enumerable: !0, configurable: !0 }), Object.defineProperty(e.prototype, "ErrorCode", { get: function () { return this.privErrorCode }, enumerable: !0, configurable: !0 }), e }(); t.CancellationDetails = i }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }), function (e) { e[e.NoError = 0] = "NoError", e[e.AuthenticationFailure = 1] = "AuthenticationFailure", e[e.BadRequestParameters = 2] = "BadRequestParameters", e[e.TooManyRequests = 3] = "TooManyRequests", e[e.ConnectionFailure = 4] = "ConnectionFailure", e[e.ServiceTimeout = 5] = "ServiceTimeout", e[e.ServiceError = 6] = "ServiceError", e[e.RuntimeError = 7] = "RuntimeError" }(t.CancellationErrorCode || (t.CancellationErrorCode = {})) }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var r = n(0), o = n(1), i = n(6), s = function () { function e(t, n) { var r = this; this.streams = {}, this.TurnOn = function () { if ("undefined" == typeof FileReader) { var t = "Browser does not support FileReader."; return r.OnEvent(new o.AudioSourceErrorEvent(t, "")), o.PromiseHelper.FromError(t) } if (r.file.name.lastIndexOf(".wav") !== r.file.name.length - 4) { t = r.file.name + " is not supported. Only WAVE files are allowed at the moment."; return r.OnEvent(new o.AudioSourceErrorEvent(t, "")), o.PromiseHelper.FromError(t) } if (r.file.size > e.MAX_SIZE) { t = r.file.name + " exceeds the maximum allowed file size (" + e.MAX_SIZE + ")."; return r.OnEvent(new o.AudioSourceErrorEvent(t, "")), o.PromiseHelper.FromError(t) } return r.OnEvent(new o.AudioSourceInitializingEvent(r.id)), r.OnEvent(new o.AudioSourceReadyEvent(r.id)), o.PromiseHelper.FromResult(!0) }, this.Id = function () { return r.id }, this.Attach = function (e) { return r.OnEvent(new o.AudioStreamNodeAttachingEvent(r.id, e)), r.Upload(e).OnSuccessContinueWith(function (t) { return r.OnEvent(new o.AudioStreamNodeAttachedEvent(r.id, e)), { Detach: function () { t.Close(), delete r.streams[e], r.OnEvent(new o.AudioStreamNodeDetachedEvent(r.id, e)), r.TurnOff() }, Id: function () { return e }, Read: function () { return t.Read() } } }) }, this.Detach = function (e) { e && r.streams[e] && (r.streams[e].Close(), delete r.streams[e], r.OnEvent(new o.AudioStreamNodeDetachedEvent(r.id, e))) }, this.TurnOff = function () { for (var e in r.streams) if (e) { var t = r.streams[e]; t && !t.IsClosed && t.Close() } return r.OnEvent(new o.AudioSourceOffEvent(r.id)), o.PromiseHelper.FromResult(!0) }, this.Upload = function (t) { return r.TurnOn().OnSuccessContinueWith(function (n) { var s = new o.Stream(t); r.streams[t] = s; var c = new FileReader, a = 0, u = e.CHUNK_SIZE, p = 0, l = function (t) { if (!s.IsClosed) { if (0 !== p) { var n = Date.now() - p; if (n < e.UPLOAD_INTERVAL) return void new i.Timer(e.UPLOAD_INTERVAL - n, l).start() } if (s.Write(c.result), p = Date.now(), u < r.file.size) { a = u, u = Math.min(u + e.CHUNK_SIZE, r.file.size); var o = r.file.slice(a, u); c.readAsArrayBuffer(o) } else s.Close() } }; c.onload = l, c.onerror = function (e) { var n = "Error occurred while processing '" + r.file.name + "'. " + e.error; throw r.OnEvent(new o.AudioStreamNodeErrorEvent(r.id, t, e.error)), new Error(n) }; var f = r.file.slice(a, u); return c.readAsArrayBuffer(f), s.GetReader() }) }, this.OnEvent = function (e) { r.events.OnEvent(e), o.Events.Instance.OnEvent(e) }, this.id = n || o.CreateNoDashGuid(), this.events = new o.EventSource, this.file = t } return Object.defineProperty(e.prototype, "Format", { get: function () { return e.FILEFORMAT }, enumerable: !0, configurable: !0 }), Object.defineProperty(e.prototype, "Events", { get: function () { return this.events }, enumerable: !0, configurable: !0 }), e.SAMPLE_RATE = 32e3, e.CHUNK_SIZE = 2 * e.SAMPLE_RATE / 5, e.UPLOAD_INTERVAL = 200, e.MAX_SIZE = 600 * e.SAMPLE_RATE + 44, e.FILEFORMAT = r.AudioStreamFormat.getWaveFormatPCM(16e3, 16, 1), e }(); t.FileAudioSource = s }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var r = function () { return function (e) { var t = this; this.Record = function (e, n, r) { var o = new MediaRecorder(n, t.mediaRecorderOptions); o.ondataavailable = function (e) { if (r) { var t = new FileReader; t.readAsArrayBuffer(e.data), t.onloadend = function (e) { r.Write(t.result) } } }, t.mediaResources = { recorder: o, stream: n }, o.start(100) }, this.ReleaseMediaResources = function (e) { "inactive" !== t.mediaResources.recorder.state && t.mediaResources.recorder.stop(), t.mediaResources.stream.getTracks().forEach(function (e) { return e.stop() }) }, this.mediaRecorderOptions = e } }(); t.OpusRecorder = r }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var r = n(1), o = function () { return function () { var e = this; this.Record = function (t, n, o) { var i = function () { var e = 0; try { return t.createScriptProcessor(e, 1, 1) } catch (r) { e = 2048; for (var n = t.sampleRate; e < 16384 && n >= 32e3;)e <<= 1, n >>= 1; return t.createScriptProcessor(e, 1, 1) } }(), s = new r.RiffPcmEncoder(t.sampleRate, 16e3), c = !0; i.onaudioprocess = function (e) { var t = e.inputBuffer.getChannelData(0); if (o && !o.IsClosed) { var n = s.Encode(c, t); n && (o.Write(n), c = !1) } }; var a = t.createMediaStreamSource(n); e.mediaResources = { scriptProcessorNode: i, source: a, stream: n }, a.connect(i), i.connect(t.destination) }, this.ReleaseMediaResources = function (t) { e.mediaResources && (e.mediaResources.scriptProcessorNode && (e.mediaResources.scriptProcessorNode.disconnect(t.destination), e.mediaResources.scriptProcessorNode = null), e.mediaResources.source && (e.mediaResources.source.disconnect(), e.mediaResources.stream.getTracks().forEach(function (e) { return e.stop() }), e.mediaResources.source = null)) } } }(); t.PcmRecorder = o }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var r = n(1), o = function () { return function () { this.Get = function (e) { if (!e) throw new r.ArgumentNullError("key"); return sessionStorage.getItem(e) }, this.GetOrAdd = function (e, t) { if (!e) throw new r.ArgumentNullError("key"); var n = sessionStorage.getItem(e); return null == n && sessionStorage.setItem(e, t), sessionStorage.getItem(e) }, this.Set = function (e, t) { if (!e) throw new r.ArgumentNullError("key"); sessionStorage.setItem(e, t) }, this.Remove = function (e) { if (!e) throw new r.ArgumentNullError("key"); sessionStorage.removeItem(e) } } }(); t.SessionStorage = o }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var r = function () { return function (e, t) { var n = this; this.start = function () { for (var e = [], t = 0; t < arguments.length; t++)e[t] = arguments[t]; n.timerId && n.stop(), n.timerId = setTimeout(n.successCallback, n.delayInMillisec, e) }, this.stop = function () { clearTimeout(n.timerId) }, this.delayInMillisec = e, this.successCallback = t } }(); t.Timer = r }, function (e, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var r = n(1), o = n(20), i = function () { function e(e, t, n, i, s) { var c = this; if (this.isDisposed = !1, this.Dispose = function () { c.isDisposed = !0, c.connectionMessageAdapter && c.connectionMessageAdapter.Close() }, this.IsDisposed = function () { return c.isDisposed }, this.State = function () { return c.connectionMessageAdapter.State }, this.Open = function () { return c.connectionMessageAdapter.Open() }, this.Send = function (e) { return c.connectionMessageAdapter.Send(e) }, this.Read = function () { return c.connectionMessageAdapter.Read() }, !e) throw new r.ArgumentNullError("uri"); if (!i) throw new r.ArgumentNullError("messageFormatter"); this.messageFormatter = i; var a = "", u = 0; if (t) for (var p in t) { if (p) a += 0 === u && -1 === e.indexOf("?") ? "?" : "&", a += p + "=" + encodeURIComponent(t[p]), u++ } if (n) for (var l in n) { if (l) a += 0 === u ? "?" : "&", a += l + "=" + encodeURIComponent(n[l]), u++ } this.uri = e + a, this.id = s || r.CreateNoDashGuid(), this.connectionMessageAdapter = new o.WebsocketMessageAdapter(this.uri, this.Id, this.messageFormatter) } return Object.defineProperty(e.prototype, "Id", { get: function () { return this.id }, enumerable: !0, configurable: !0 }), Object.defineProperty(e.prototype, "Events", { get: function () { return this.connectionMessageAdapter.Events }, enumerable: !0, configurable: !0 }), e }(); t.WebsocketConnection = i }]);